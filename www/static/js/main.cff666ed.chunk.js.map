{"version":3,"sources":["images/logo.svg","global-jquery.js","AbstractFlash.js","NoticeFlash.js","AlertFlash.js","Flash.js","LoginForm.js","EventHive.js","keyboard.js","ViewportMode.js","Uuid.js","Note.js","Spinner.js","NoteList.js","highlight.js","NoteForm.js","PushState.js","Navbar.js","SaveStateLabel.js","AddNoteButton.js","SyncStorage.js","AutoSave.js","NoteEdit.js","App.js","registerServiceWorker.js","setGlobals.js","setApiHost.js","index.js"],"names":["module","exports","__webpack_require__","p","window","jQuery","$","AbstractFlash","props","context","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","state","message","react_default","a","createElement","className","getCssClass","type","onClick","handleClose","bind","dangerouslySetInnerHTML","__html","getAdditionalCssClass","join","setState","_this2","document","on","constructor","getEventName","e","data","off","prototype","getName","trigger","Component","NoticeFlash","AlertFlash","Flash","src_NoticeFlash","src_AlertFlash","LoginForm","onSubmit","handleFormSubmit","value","name","renderEmail","renderPassword","renderRememberMe","renderSubmit","htmlFor","id","autoFocus","preventDefault","target","serialize","ajax","url","method","dataType","done","clear","onLoginSuccess","fail","show","EventHive","topic","listener","topics","hasOwnProperty","index","push","remove","info","forEach","item","undefined","_topics","Mousetrap","stopCallback","publish","ViewportMode","envs","doc","temp","body","appendChild","i","length","env","offsetParent","removeChild","mode","getMode","Uuid","replace","c","r","Math","random","toString","Note","uid","title","content","createdAt","updatedAt","_uid","generateV4","_title","_content","_createdAt","Date","_updatedAt","_serverUpdatedAt","JSON","stringify","created_at","toISOString","updated_at","server_updated_at","serverUpdatedAt","attributes","Spinner","viewBox","xmlns","fill","strokeWidth","strokeLinecap","cx","cy","NoteList","notes","currentPage","hasMorePages","isSynced","searchQuery","getListCssClass","ref","$list","renderList","renderNextPageLink","renderListSpinner","_this3","map","note","renderListItem","key","getListItemCssClass","handleNoteClick","getNoteAvatar","handleDeleteNoteClick","humanDate","relativeTime","handleNextPageClick","src_Spinner","cssClass","activeNoteUid","isInitialEdit","_this4","toggleListMore","isMobileMode","collapse","toggle","subscribe","listNeedsUpdate","updateList","nextProps","setSearchProgress","removeClass","currentTarget","addClass","_this5","blur","updateListRequest","abort","search","page","executeUpdateListRequest","_this6","fromAttributes","current_page","has_more_pages","xhr","status","error","console","always","match","previewImageUrl","getPreviewImageUrl","src","alt","linkIsVisible","isInProgress","hljs","highlight","NoteForm","shouldRerender","formContainerElement","renderTitle","renderContent","onChange","handleTitleChange","placeholder","titleElement","contentContainerElement","handleChange","contentElement","innerHTML","focusTitleFieldIfNewNote","renderEditor","editor","pasteHTML","classList","add","setText","history","update","handleContentChange","nextState","Quill","theme","modules","syntax","toolbar","header","color","background","list","indent","task-list","querySelector","isNew","focus","PushState","concat","location","pathname","Navbar","showSpinner","renderLogo","renderMobileHamburgerMenu","renderMobileSearchButton","renderSearchBox","logo","subscribeSpinner","subscribeSearch","subscribeMobileSearch","$searchBox","handleSearchEnter","$searchInput","handleSearchCleared","handleHamburgerButtonClick","handleSearchButtonClick","$searchButton","hasClass","$hamburger","val","select","SaveStateLabel","AddNoteButton","handleNewNoteClick","SyncStorage","localStorage","setItem","_getKey","toJson","getItem","callback","keys","_getLocalStorageKeys","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","noteRaw","parse","err","return","removeItem","startsWith","KEY_PREFIX","AutoSave","onServerSync","onServerSyncCallback","setSyncStatus","setInterval","syncToServer","POLLING_INTERVAL","set","active","eachNote","serverNote","ajaxDone","ajaxFail","isEmpty","onbeforeunload","syncStorageRawNote","get","readyState","NoteEdit","pushState","initStateFromNote","params","initStateFromNoteId","getNewNoteAttributes","handleSearchEnterDebounced","debounce","renderHeaderBar","autoSave","handleServerSync","startPolling","setNewNote","src_Navbar","src_SaveStateLabel","src_NoteList","src_NoteForm_0","handleEditChange","src_AddNoteButton","setBrowserTitle","objectSpread","setEdit","stopPropagation","bootbox","confirm","result","deleteNote","setChange","persist","afterSetState","setNew","App","isLoggedIn","setIsLoggedIn","HashRouter","src_Flash","renderLoggedIn","renderLoggedOut","material","init","Switch","Route","path","component","Redirect","from","to","src_LoginForm","isLocalhost","Boolean","hostname","registerValidSW","swUrl","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","log","catch","API_HOST","ajaxPrefilter","options","ReactDOM","render","src_App_0","getElementById","URL","process","origin","addEventListener","fetch","response","headers","indexOf","ready","unregister","reload","checkValidServiceWorker","registerServiceWorker"],"mappings":"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","file":"static/js/main.cff666ed.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/logo.8ad1a424.svg\";","import $ from 'jquery';\n\nwindow.jQuery = $;\nwindow.$ = $;\n","import React, { Component } from 'react';\nimport $ from 'jquery';\n\nclass AbstractFlash extends Component {\n  constructor(props, context) {\n    super(props, context);\n\n    this.state = { message: props.message };\n  }\n\n  render () {\n    if (!this.state.message) {\n      return null;\n    }\n\n    return (\n      <div className=\"row\">\n        <div className=\"col-md-4 col-md-offset-4\">\n          <div className={this.getCssClass()}>\n            <button className=\"close\" type=\"button\" onClick={this.handleClose.bind(this)}>×</button>\n            <div dangerouslySetInnerHTML={{ __html: this.state.message }} />\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  getCssClass() {\n    var cssClasses = ['alert', 'alert-dismissible', this.getAdditionalCssClass()];\n\n    return cssClasses.join(' ');\n  }\n\n  handleClose() {\n    this.setState({ message: null });\n  }\n\n  componentDidMount() {\n    // listen on global event so we can use `NoticeFlash.show('hello')`\n    $(document).on(this.constructor.getEventName(), (e, data) => {\n      this.setState({ message: data.message });\n    });\n  }\n\n  componentWillUnmount() {\n    $(document).off(this.constructor.getEventName());\n  }\n\n  getAdditionalCssClass() {\n  }\n\n  getName() {\n  }\n\n  static getEventName() {\n    return 'mykonote.flash.' + this.prototype.getName();\n  }\n\n  static show(message) {\n    $(document).trigger(this.getEventName(), { message: message });\n  }\n\n  static clear() {\n    $(document).trigger(this.getEventName(), { message: null });\n  }\n}\n\nexport default AbstractFlash;\n","import AbstractFlash from './AbstractFlash';\n\nclass NoticeFlash extends AbstractFlash {\n  getName() {\n    return 'notice';\n  }\n\n  getAdditionalCssClass() {\n    return 'alert-info';\n  }\n}\n\nexport default NoticeFlash;\n","import AbstractFlash from './AbstractFlash';\n\nclass AlertFlash extends AbstractFlash {\n  getName() {\n    return 'alert';\n  }\n\n  getAdditionalCssClass() {\n    return 'alert-warning';\n  }\n}\n\nexport default AlertFlash;\n","import React, { Component } from 'react';\nimport NoticeFlash from './NoticeFlash';\nimport AlertFlash from './AlertFlash';\n\nclass Flash extends Component {\n  render() {\n    return (\n      <div>\n        <NoticeFlash />\n        <AlertFlash />\n      </div>\n    );\n  }\n}\n\nexport default Flash;\n","import React, { Component } from 'react';\nimport $ from 'jquery';\nimport AlertFlash from './AlertFlash';\n\nclass LoginForm extends Component {\n  render() {\n    return (\n      <form className=\"simple_form new_user\" onSubmit={this.handleFormSubmit.bind(this)}>\n        <input type=\"hidden\" value=\"✓\" name=\"utf8\" />\n\n        <div className=\"form-inputs\">\n          {this.renderEmail()}\n          {this.renderPassword()}\n          {this.renderRememberMe()}\n        </div>\n\n        <div className=\"form-actions\">\n          {this.renderSubmit()}\n        </div>\n      </form>\n    );\n  }\n\n  renderEmail() {\n    return (\n      <div className=\"form-group email optional user_email is-empty\">\n        <label\n          htmlFor=\"user_email\"\n          className=\"email optional control-label\">Email</label>\n        <input\n          type=\"email\"\n          id=\"user_email\"\n          name=\"user[email]\"\n          autoFocus=\"autofocus\"\n          className=\"string email optional form-control\" />\n      </div>\n    );\n  }\n\n  renderPassword() {\n    return (\n      <div className=\"form-group password optional user_password is-empty\">\n        <label\n          htmlFor=\"user_password\"\n          className=\"password optional control-label\">Password</label>\n        <input\n          type=\"password\"\n          id=\"user_password\"\n          name=\"user[password]\"\n          className=\"password optional form-control\" />\n      </div>\n    );\n  }\n\n  renderRememberMe() {\n    return (\n      <div className=\"form-group boolean optional user_remember_me\">\n        <div className=\"checkbox\">\n          <label htmlFor=\"user_remember_me\" className=\"boolean optional\">\n            <input\n              type=\"checkbox\"\n              id=\"user_remember_me\"\n              name=\"user[remember_me]\"\n              value=\"1\"\n              className=\"boolean optional\" />Remember me</label>\n        </div>\n      </div>\n    );\n  }\n\n  renderSubmit() {\n    return (\n      <input\n        type=\"submit\"\n        className=\"btn btn-raised btn-primary btn-info\"\n        value=\"Log in\"\n        name=\"commit\" />\n    );\n  }\n\n  handleFormSubmit(e) {\n    e.preventDefault();\n\n    const url = '/users/sign_in';\n    const data = $(e.target).serialize();\n\n    $.ajax({\n      url: url,\n      method: 'POST',\n      dataType: 'json',\n      data: data\n    })\n    .done((data) => {\n      AlertFlash.clear();\n      this.props.onLoginSuccess();\n    })\n    .fail(() => {\n      AlertFlash.show('Sorry, that did not work. ' +\n                      'Did you enter a wrong username or a wrong password?')\n    });\n  }\n}\n\nexport default LoginForm;\n","// credits to https://davidwalsh.name/pubsub-javascript\nclass EventHive {\n  static get topics() {\n    if (typeof this._topics === 'undefined') {\n      this._topics = {};\n    }\n    return this._topics;\n  }\n\n  static subscribe(topic, listener) {\n    // Create the topic's object if not yet created\n    if (!this.topics.hasOwnProperty.call(this.topics, topic)) {\n      this.topics[topic] = [];\n    }\n\n    // Add the listener to queue\n    var index = this.topics[topic].push(listener) -1;\n\n    // Provide handle back for removal of topic\n    return {\n      remove: () => {\n        delete this.topics[topic][index];\n      }\n    };\n  }\n\n  static publish(topic, info) {\n    // If the topic doesn't exist, or there's no listeners in queue, just leave\n    if (!this.topics.hasOwnProperty.call(this.topics, topic)) {\n      return;\n    }\n\n    // Cycle through topics queue, fire!\n    this.topics[topic].forEach(function(item) {\n      item(info !== undefined ? info : {});\n    });\n  }\n}\n\nexport default EventHive;\n","import Mousetrap from 'mousetrap'\nimport EventHive from './EventHive';\n\n// always fire shortcuts inside input fields\nMousetrap.prototype.stopCallback = function() { return false }\n\nMousetrap.bind('alt+shift+f', function() {\n  EventHive.publish('search.focus');\n\n  return false;\n});\n\nMousetrap.bind('alt+shift+n', function() {\n  EventHive.publish('note.new');\n\n  return false;\n});\n","// https://stackoverflow.com/questions/19462672/jquery-detect-bootstrap-3-state/24884634#24884634\nclass ViewportMode {\n  static getMode() {\n    const envs = [\"xs\", \"sm\", \"md\", \"lg\"];\n    const doc = window.document;\n    const temp = doc.createElement(\"div\");\n\n    doc.body.appendChild(temp);\n\n    for (let i = envs.length - 1; i >= 0; i--) {\n      const env = envs[i];\n\n      temp.className = \"hidden-\" + env;\n\n      if (temp.offsetParent === null) {\n        doc.body.removeChild(temp);\n        return env;\n      }\n    }\n    return \"\";\n  }\n\n  static isMobileMode() {\n    const mode = this.getMode();\n    return mode === 'xs' || mode === 'sm';\n  }\n}\n\nexport default ViewportMode;\n","class Uuid  {\n  static generateV4() {\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n      var r = Math.random() * 16 | 0, v = c === 'x' ? r : ((r & 0x3) | 0x8);\n      return v.toString(16);\n    });\n  }\n}\n\nexport default Uuid;\n","import Uuid from './Uuid';\n\nclass Note {\n  constructor(uid, title, content, createdAt, updatedAt) {\n    this._uid = uid || Uuid.generateV4();\n    this._title = title || '';\n    this._content = content || '';\n    this._createdAt = createdAt || new Date();\n    this._updatedAt = updatedAt || this._createdAt;\n    this._serverUpdatedAt = this._updatedAt;\n  }\n\n  get uid() { return this._uid }\n\n  get title() { return this._title }\n  set title(title) {\n    this._updatedAt = new Date();\n    this._title = title;\n  }\n\n  get content() { return this._content }\n  set content(content) {\n    this._updatedAt = new Date();\n    this._content = content;\n  }\n\n  get createdAt() { return this._createdAt }\n  get updatedAt() { return this._updatedAt }\n\n  get serverUpdatedAt() { return this._serverUpdatedAt }\n  set serverUpdatedAt(serverUpdatedAt) { this._serverUpdatedAt = serverUpdatedAt }\n\n  isNew() {\n    return !this.title && !this.content;\n  }\n\n  toJson() {\n    return JSON.stringify(\n      {\n        uid: this.uid,\n        title: this.title,\n        content: this.content,\n        created_at: this.createdAt.toISOString(),\n        updated_at: this.updatedAt.toISOString(),\n        server_updated_at: this.serverUpdatedAt.toISOString()\n      }\n    );\n  }\n\n  static fromAttributes(attributes) {\n    return new Note(\n      attributes.uid,\n      attributes.title,\n      attributes.content,\n      new Date(attributes.created_at),\n      new Date(attributes.updated_at)\n    );\n  }\n}\n\nexport default Note;\n","import React from 'react';\n\nfunction Spinner() {\n  return (\n    <svg\n      className=\"spinner\"\n      viewBox=\"0 0 66 66\"\n      xmlns=\"http://www.w3.org/2000/svg\">\n      <circle\n        className=\"path\"\n        fill=\"none\"\n        strokeWidth=\"6\"\n        strokeLinecap=\"round\"\n        cx=\"33\"\n        cy=\"33\"\n        r=\"30\"></circle>\n    </svg>\n  );\n}\n\nexport default Spinner;\n","import React, { Component } from 'react';\nimport humanDate from 'human-date';\nimport $ from 'jquery';\nimport ViewportMode from './ViewportMode';\nimport EventHive from './EventHive';\nimport Note from './Note';\nimport AlertFlash from './AlertFlash';\nimport Spinner from './Spinner';\n\nclass NoteList extends Component {\n  constructor(props, context) {\n    super(props, context);\n\n    this.state = {\n      notes: [],\n      currentPage: 1,\n      hasMorePages: false,\n      isSynced: false,\n      searchQuery: undefined\n    };\n  }\n\n  render() {\n    return (\n      <div className={this.getListCssClass()} ref={(c) => this.$list = $(c)}>\n        {this.renderList()}\n        {this.renderNextPageLink()}\n        {this.renderListSpinner()}\n      </div>\n    );\n  }\n\n  renderList() {\n    return this.state.notes.map((note) => this.renderListItem(note));\n  }\n\n  renderListItem(note) {\n    return (\n      <div key={note.uid}>\n        <div\n          className={this.getListItemCssClass(note)}\n          onClick={this.handleNoteClick.bind(this, note)}>\n\n          <div className=\"row-picture\">\n            {this.getNoteAvatar(note)}\n          </div>\n          <div className=\"row-content\">\n            <div\n              className=\"action-secondary\"\n              onClick={this.props.handleDeleteNoteClick.bind(this, note)}>\n              <i className=\"material-icons\">delete</i>\n            </div>\n            <h4 className=\"list-group-item-heading\">\n              {note.title}\n            </h4>\n            <div className=\"list-group-item-text\">\n              {humanDate.relativeTime(note.updatedAt)}\n            </div>\n          </div>\n        </div>\n        <div className=\"list-group-separator\"></div>\n      </div>\n    );\n  }\n\n  renderNextPageLink() {\n    if (!this.state.hasMorePages) { return; }\n\n    return (\n      <div className=\"list-more list-more-next-page\">\n        <button onClick={this.handleNextPageClick.bind(this)} className=\"btn btn-info btn-link btn-sm\">\n          <i className=\"material-icons list-more-icon\">expand_more</i>\n        </button>\n      </div>\n    );\n  }\n\n  renderListSpinner() {\n    return (\n      <div className=\"list-more list-more-spinner hidden\">\n        <Spinner />\n      </div>\n    );\n  }\n\n  getListItemCssClass(note) {\n    let cssClass = 'list-group-item note-navigation-item';\n    if (note.uid === this.props.activeNoteUid) {\n      cssClass += ' active';\n    }\n\n    return cssClass;\n  }\n\n  getListCssClass() {\n    // in-sm: show always for non-mobile view\n    let cssClass = 'list-group notes-list collapse in-sm';\n    // show on mobile when not accessing a direct edit url\n    if (!this.props.isInitialEdit) {\n      cssClass += ' in';\n    }\n\n    return cssClass;\n  }\n\n  componentDidMount() {\n    this.toggleListMore(false);\n\n    // handle hamburger and search toggling\n    if (ViewportMode.isMobileMode()) {\n      this.$list.collapse({ toggle: false });\n      // when the hiding animation is done\n      this.$list.on('hidden.bs.collapse', () => {\n        EventHive.publish('hamburger.hide_end');\n      });\n\n      EventHive.subscribe('hamburger.show', () => {\n        this.$list.collapse('show');\n      });\n      EventHive.subscribe('hamburger.hide', () => {\n        this.$list.collapse('hide');\n      });\n\n      EventHive.subscribe('search.entered', () => {\n        this.$list.collapse('show');\n      });\n\n      EventHive.subscribe('note.open', () => {\n        this.$list.collapse('hide');\n      });\n    }\n  }\n\n  componentDidUpdate() {\n    if (this.listNeedsUpdate) {\n      this.listNeedsUpdate = false;\n      this.updateList();\n    }\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (!this.state.isSynced && nextProps.isSynced) {\n      this.listNeedsUpdate = true;\n    }\n\n    if (this.state.searchQuery !== nextProps.searchQuery) {\n      this.listNeedsUpdate = true;\n      this.setSearchProgress(true);\n    }\n\n    this.setState( {\n      isSynced: nextProps.isSynced,\n      searchQuery: nextProps.searchQuery\n    });\n  }\n\n  handleNoteClick(note, e) {\n    $('.note-navigation-item').removeClass('active');\n    $(e.currentTarget).addClass('active');\n\n    if (ViewportMode.isMobileMode()) {\n      EventHive.publish('hamburger.hide');\n    }\n\n    EventHive.publish('note.open');\n    this.props.handleNoteClick(note, e);\n  }\n\n  handleNextPageClick(e) {\n    e.preventDefault();\n    $(e.currentTarget).blur();\n\n    this.toggleListMore(false);\n\n    this.setState({ currentPage: this.state.currentPage + 1 }, () => {\n      this.updateList();\n    });\n  }\n\n  updateList() {\n    if (this.updateListRequest) {\n      this.updateListRequest.abort();\n    }\n\n    this.updateListRequest = $.ajax({\n      url: '/api/notes',\n      dataType: 'json',\n      data: { search: this.state.searchQuery, page: this.state.currentPage }\n    });\n\n    this.executeUpdateListRequest();\n  }\n\n  executeUpdateListRequest() {\n    this.updateListRequest\n      .done((data) => {\n        this.toggleListMore(true);\n\n        const notes = data.notes.map(function(note) {\n          return Note.fromAttributes(note);\n        });\n\n        this.setState({\n          notes: notes,\n          currentPage: data.current_page,\n          hasMorePages: data.has_more_pages\n        });\n      })\n      .fail((xhr, status, error) => {\n        // it's not a failure when the request was aborted by a subsequent\n        // request (see call to `abort()` above).\n        if (error === 'abort') {\n          return;\n        }\n\n        this.toggleListMore(true);\n\n        AlertFlash.show('Watch out, the list is not up to date.');\n        console.error('url: ', this.props.url, 'status: ', status, 'error: ', error.toString());\n      })\n      .always(() => {\n        this.setSearchProgress(false);\n      });\n  }\n\n  getPreviewImageUrl(note) {\n    var match = note.content.match(/<img.*? src=['\"]([^'\"]+)['\"].*?>/);\n    if (match) {\n      return match[1];\n    }\n    else {\n      return null;\n    }\n  }\n\n  getNoteAvatar(note) {\n    var previewImageUrl = this.getPreviewImageUrl(note);\n    if (previewImageUrl) {\n      return <img src={previewImageUrl} className=\"circle\" alt=\"note thumbnail\" />;\n    }\n    else {\n      return <i className=\"material-icons\">subject</i>;\n    }\n  }\n\n  toggleListMore(linkIsVisible) {\n    if (linkIsVisible) {\n      $('.list-more-next-page').removeClass('hidden');\n      $('.list-more-spinner').addClass('hidden');\n    }\n    else {\n      $('.list-more-next-page').addClass('hidden');\n      $('.list-more-spinner').removeClass('hidden');\n    }\n  }\n\n  setSearchProgress(isInProgress) {\n    EventHive.publish('spinner.toggle', { show: isInProgress });\n  }\n}\n\nexport default NoteList;\n","import highlight from 'highlight.js/lib/highlight';\nimport 'highlight.js/styles/railscasts.css';\n\nwindow.hljs = highlight;\n","import './highlight.js';\nimport React, { Component } from 'react';\nimport Quill from 'quill';\nimport 'quill-task-list/task_list_node';\nimport 'quill/dist/quill.snow.css';\nimport './NoteForm.css';\nimport EventHive from './EventHive';\nimport ViewportMode from './ViewportMode';\n\nclass NoteForm extends Component {\n  constructor(props, context) {\n    super(props, context);\n\n    this.state = {\n      note: this.props.note\n    };\n\n    this.shouldRerender = true;\n  }\n\n  render() {\n    return (\n      <div>\n        <form\n          className=\"form-horizontal\"\n          ref={(c) => this.formContainerElement = c}\n          onSubmit={this.handleFormSubmit}>\n          <div className=\"form-inputs\">\n            {this.renderTitle()}\n            {this.renderContent()}\n          </div>\n        </form>\n      </div>\n    );\n  }\n\n  renderTitle() {\n    return (\n      <div className=\"form-group form-group-no-label string optional\">\n        <input\n          type=\"text\"\n          className=\"string optional form-control\"\n          value={this.state.note.title}\n          onChange={this.handleTitleChange.bind(this)}\n          placeholder=\"Title\"\n          ref={(c) => this.titleElement = c}\n        />\n      </div>\n    );\n  }\n\n  renderContent() {\n    return (\n      <div className=\"form-group form-group-no-label text optional\">\n        <div\n          ref={(c) => this.contentContainerElement = c}\n        ></div>\n      </div>\n    );\n  }\n\n  // prevent form submission by hitting enter.\n  // changes will be asynchronously saved by ajax.\n  handleFormSubmit(e) {\n    e.preventDefault();\n    return false;\n  }\n\n  handleTitleChange() {\n    this.shouldRerender = true;\n    const note = this.state.note;\n    note.title = this.titleElement.value;\n    this.setState({ note: note }, this.handleChange);\n  }\n\n  handleContentChange() {\n    this.shouldRerender = false;\n    const note = this.state.note;\n    note.content = this.contentElement.innerHTML;\n    this.setState({ note: note }, this.handleChange);\n  }\n\n  handleChange() {\n    this.props.handleChange(this.state.note);\n  }\n\n  componentDidMount() {\n    this.focusTitleFieldIfNewNote();\n    this.renderEditor();\n\n    // when updating the note from outside (e.g. from the mobile app), in which\n    // case a sync to the server should be triggered. if we just use the react\n    // eventing the rte won't detect the changes.\n    EventHive.subscribe('note.update', (data) => {\n      this.titleElement.value = data.title;\n      this.handleTitleChange();\n      this.editor.pasteHTML(data.content);\n    });\n\n    if (ViewportMode.isMobileMode()) {\n      EventHive.subscribe('hamburger.show', () => {\n        this.formContainerElement.classList.add('hidden');\n      });\n      EventHive.subscribe('hamburger.hide', () => {\n        this.formContainerElement.classList.remove('hidden');\n      });\n\n      EventHive.subscribe('search.entered', () => {\n        this.formContainerElement.classList.add('hidden');\n      });\n    }\n  }\n\n  // gets called initially and when a note is switched\n  componentDidUpdate() {\n    this.editor.off('text-change');\n    // reset the content before inserting the actual content.\n    // presumably because of change tracking (delta stuff) in quill the\n    // insertion of big content hangs the browser for several seconds.\n    this.editor.setText('');\n    this.contentElement.innerHTML = this.state.note.content;\n    this.editor.history.clear();\n    // wait on updates before attaching the `text-change` event\n    this.editor.update();\n    this.editor.on('text-change', this.handleContentChange.bind(this));\n  }\n\n  componentWillReceiveProps(nextProps) {\n    // a different note is shown.\n    if (nextProps.note.uid !== this.state.note.uid) {\n      this.shouldRerender = true;\n      this.setState({\n        note: nextProps.note\n      }, () => this.focusTitleFieldIfNewNote());\n    }\n  }\n\n  shouldComponentUpdate(nextProps, nextState) {\n    // don't rerender if the RTE content changes. the cursor jumps to the\n    // beginning of the content if we re-initialize the RTE content.\n    return this.shouldRerender;\n  }\n\n  renderEditor() {\n    this.editor = new Quill(this.contentContainerElement, {\n      theme: 'snow',\n      modules: {\n        'syntax': true,\n        'toolbar': [\n          [{ 'header': [1, 2, false] }],\n          ['bold', 'italic', 'strike'],\n          [{ 'color': [] }, { 'background': [] }],\n          ['blockquote', 'code-block'],\n          [\n            { 'list': 'ordered' }, { 'list': 'bullet' }, 'task-list',\n            { 'indent': '-1' }, { 'indent': '+1' }\n          ],\n          ['link', 'image'],\n          ['clean']\n        ],\n        'task-list': true\n      }\n    });\n\n    this.contentElement = this.contentContainerElement.querySelector('.ql-editor');\n  }\n\n  focusTitleFieldIfNewNote() {\n    if (this.state.note.isNew()) {\n      this.titleElement.focus();\n    }\n  }\n}\n\nexport default NoteForm;\n","class PushState {\n  constructor(history) {\n    this.history = history;\n  }\n\n  setNew() {\n    this.history.push('/notes');\n  }\n\n  setEdit(note) {\n    const url = `/notes/${note.uid}`;\n\n    if (this.history.location.pathname !== url) {\n      this.history.push(url);\n    }\n  }\n\n  setBrowserTitle(note) {\n    if (note && note.title) {\n      document.title = `${note.title} | Mykonote`;\n    }\n    else {\n      document.title = 'Mykonote';\n    }\n  }\n}\n\nexport default PushState;\n","import React, { Component } from 'react';\nimport $ from 'jquery';\nimport EventHive from './EventHive';\nimport ViewportMode from './ViewportMode';\nimport Spinner from './Spinner';\nimport logo from './images/logo.svg';\n\nclass Navbar extends Component {\n  constructor(props, context) {\n    super(props, context);\n\n    this.state = { showSpinner: false };\n  }\n\n  render() {\n    return (\n      <div className=\"row\">\n        <div className=\"col-md-4\">\n          <div className=\"navbar-header\">\n            {this.renderLogo()}\n            {this.renderMobileHamburgerMenu()}\n            {this.renderMobileSearchButton()}\n          </div>\n          {this.renderSearchBox()}\n        </div>\n      </div>\n    );\n  }\n\n  renderLogo() {\n    return (\n      <div className=\"navbar-brand\">\n        <div className=\"navbar-spinner\">\n          {this.state.showSpinner ? (\n            <Spinner />\n          ) : (\n            <div className=\"navbar-logo\">\n              <img src={logo} alt=\"logo\" />\n            </div>\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  componentDidMount() {\n    this.subscribeSpinner();\n    this.subscribeSearch();\n    this.subscribeMobileSearch();\n  }\n\n  componentWillUnmount() {\n    this.$searchBox.off('shown.bs.collapse');\n  }\n\n  renderSearchBox() {\n    return (\n      <div\n        className=\"navbar-form navbar-right search-bar collapse in-sm\"\n        ref={(c) => this.$searchBox = $(c)}>\n        <input\n          type=\"text\"\n          className=\"string optional form-control search-input\"\n          placeholder=\"Search\"\n          onChange={this.props.handleSearchEnter}\n          ref={(c) => this.$searchInput = $(c)} />\n        <button\n          type=\"button\"\n          className=\"close clear-search\"\n          onClick={this.handleSearchCleared.bind(this)}>×</button>\n      </div>\n    );\n  }\n\n  renderMobileHamburgerMenu() {\n    return (\n      <button\n        className=\"navbar-toggle navbar-hamburger-button\"\n        type=\"button\"\n        onClick={this.handleHamburgerButtonClick}>\n        <span className=\"icon-bar\"></span>\n        <span className=\"icon-bar\"></span>\n        <span className=\"icon-bar\"></span>\n      </button>\n    );\n  }\n\n  renderMobileSearchButton() {\n    return (\n      <button\n        className=\"navbar-toggle navbar-search-button\" type=\"button\"\n        onClick={this.handleSearchButtonClick.bind(this)}\n        ref={(c) => this.$searchButton = $(c)}>\n        <i className=\"material-icons\">search</i>\n      </button>\n    );\n  }\n\n  getSpinnerCssClass() {\n    let cssClass = 'spinner';\n    if (!this.state.showSpinner) {\n      cssClass += ' hidden';\n    }\n\n    return cssClass;\n  }\n\n  getLogoCssClass() {\n    let cssClass = 'navbar-logo';\n    if (this.state.showSpinner) {\n      cssClass += ' hidden';\n    }\n\n    return cssClass;\n  }\n\n  handleSearchButtonClick() {\n    if (!ViewportMode.isMobileMode()) {\n      return;\n    }\n\n    if (this.$searchButton.hasClass('is-expanded')) {\n      this.$searchButton.removeClass('is-expanded');\n      EventHive.publish('search.hide');\n    }\n    else {\n      this.$searchButton.addClass('is-expanded');\n      EventHive.publish('search.show');\n    }\n  }\n\n  handleHamburgerButtonClick(e) {\n    if (!ViewportMode.isMobileMode()) {\n      return;\n    }\n\n    const $hamburger = $(e.target);\n    if ($hamburger.hasClass('is-expanded')) {\n      $hamburger.removeClass('is-expanded');\n      EventHive.publish('hamburger.hide');\n    }\n    else {\n      $hamburger.addClass('is-expanded');\n      EventHive.publish('hamburger.show');\n    }\n  }\n\n  handleSearchCleared(e) {\n    this.$searchInput.val('');\n    $(e.target).blur();\n    this.props.handleSearchCleared();\n  }\n\n  subscribeSpinner() {\n    // listen on global event so we can toggle the spinner from unrelated\n    // components\n    EventHive.subscribe('spinner.toggle', (data) => {\n      this.setState({ showSpinner: data.show });\n    });\n  }\n\n  subscribeSearch() {\n    EventHive.subscribe('search.focus', () => {\n      this.$searchInput.focus();\n      this.$searchInput.select();\n    });\n  }\n\n  subscribeMobileSearch() {\n    // handle hamburger and search toggling\n    if (ViewportMode.isMobileMode()) {\n      EventHive.subscribe('search.hide', () => {\n        this.$searchButton.removeClass('is-expanded');\n      });\n\n      this.$searchBox.collapse({ toggle: false });\n      // when the hiding animation is done\n      this.$searchBox.on('hidden.bs.collapse', () => {\n        EventHive.publish('search.hide_end');\n      });\n\n      EventHive.subscribe('search.show', () => {\n        this.$searchBox.collapse('show');\n      });\n      EventHive.subscribe('search.hide', () => {\n        this.$searchBox.collapse('hide');\n      });\n\n      EventHive.subscribe('note.open', () => {\n        if (this.$searchInput.val() === '') {\n          EventHive.publish('search.hide');\n        }\n      });\n\n      // event when search box is fully toggled (see bootstrap collapse)\n      this.$searchBox.on('shown.bs.collapse', () => {\n        this.$searchInput.focus();\n      });\n    }\n  }\n}\n\nexport default Navbar;\n","import React, { Component } from 'react';\n\nclass SaveStateLabel extends Component {\n  constructor(props, context) {\n    super(props, context);\n\n    this.state = { isSynced: props.isSynced };\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.setState({ isSynced: nextProps.isSynced });\n  }\n\n  render () {\n    return (\n      <div className=\"save-state\">\n        {\n          this.state.isSynced\n            ?\n            <div className=\"label label-success\">Saved</div>\n            :\n            <div className=\"label label-warning\">Saving</div>\n        }\n      </div>\n    );\n  }\n}\n\nexport default SaveStateLabel;\n","import React, { Component } from 'react';\nimport ViewportMode from './ViewportMode';\nimport EventHive from './EventHive';\n\nclass AddNoteButton extends Component {\n  render () {\n    return (\n      <button\n        className=\"btn btn-info btn-fab btn-new-note\"\n        onClick={this.handleNewNoteClick.bind(this)}\n      >\n        <i className=\"material-icons\">add</i>\n      </button>\n    );\n  }\n\n  handleNewNoteClick(e) {\n    e.preventDefault();\n\n    if (ViewportMode.isMobileMode()) {\n      EventHive.publish('hamburger.hide');\n    }\n\n    this.props.handleNewNoteClick();\n  }\n}\n\nexport default AddNoteButton;\n","class SyncStorage {\n  static get KEY_PREFIX() {\n    return 'note-';\n  }\n\n  static set(note) {\n    localStorage.setItem(\n      SyncStorage._getKey(note),\n      note.toJson()\n    );\n  }\n\n  static get(note) {\n    return localStorage.getItem(SyncStorage._getKey(note));\n  }\n\n  static eachNote(callback) {\n    const keys = SyncStorage._getLocalStorageKeys();\n\n    for (let key of keys) {\n      const noteRaw = localStorage.getItem(key);\n      const note = JSON.parse(noteRaw);\n\n      callback(note, noteRaw);\n    }\n  }\n\n  static remove(note) {\n    localStorage.removeItem(SyncStorage._getKey(note));\n  }\n\n  static isEmpty() {\n    return SyncStorage._getLocalStorageKeys().length === 0;\n  }\n\n  static _getLocalStorageKeys() {\n    let keys = [];\n    const length = localStorage.length;\n\n    for (let i = 0; i < length; ++i) {\n      const key = localStorage.key(i);\n\n      if (key.startsWith(SyncStorage.KEY_PREFIX)) {\n        keys.push(key);\n      }\n    }\n\n    return keys;\n  }\n\n  static _getKey(note) {\n    return SyncStorage.KEY_PREFIX + note.uid;\n  }\n}\n\nexport default SyncStorage;\n","import $ from 'jquery';\nimport SyncStorage from './SyncStorage';\nimport Note from './Note';\nimport AlertFlash from './AlertFlash';\n\nclass AutoSave {\n  constructor(onServerSync) {\n    this.onServerSyncCallback = onServerSync;\n\n    this.setSyncStatus();\n  }\n\n  static get POLLING_INTERVAL() {\n    return 3000;\n  }\n\n  startPolling() {\n    setInterval(this.syncToServer.bind(this), AutoSave.POLLING_INTERVAL);\n  }\n\n  setChange(note) {\n    this.setSyncStatus(false);\n\n    SyncStorage.set(note);\n  }\n\n  syncToServer() {\n    if ($.active) {\n      return;\n    }\n\n    SyncStorage.eachNote((note, noteRaw) => {\n      const url = '/api/notes/' + note.uid;\n\n      $.ajax({\n        url: url,\n        method: 'PUT',\n        dataType: 'json',\n        data: { note: note }\n      })\n      // `serverNote` is just a partial note, the response doesn't contain all\n      // attributes\n      .done((serverNote) => this.ajaxDone(note, noteRaw, Note.fromAttributes(serverNote)))\n      .fail((xhr, status, error) => this.ajaxFail(xhr, status, error, url));\n    });\n  }\n\n  setSyncStatus(isSynced, serverNote) {\n    if (isSynced === undefined) {\n      isSynced = SyncStorage.isEmpty();\n    }\n\n    if (isSynced) {\n      window.onbeforeunload = undefined;\n    }\n    else {\n      window.onbeforeunload = function() {\n        return \"Behold! You have unsynchronized changes. \" +\n          \"If you leave the page now, your changes won't be saved to the server.\\n\" +\n          \"(Your data won't be lost, but it will only remain locally in your browser)\";\n      };\n    }\n    this.onServerSyncCallback({ isSynced: isSynced, note: serverNote });\n  }\n\n  ajaxDone(note, noteRaw, serverNote) {\n    // if the content is still the same -> clear from sync storage\n    const syncStorageRawNote = SyncStorage.get(note);\n    if (noteRaw === syncStorageRawNote) {\n      SyncStorage.remove(note);\n    }\n    else {\n      // update the server updated at in the sync storage item as well.  the\n      // content may have been updated in the meantime from the same source. if\n      // we don't do this we will get a conflict, which is not what we want in\n      // this case.\n      const note = Note.fromAttributes(JSON.parse(syncStorageRawNote));\n      note.serverUpdatedAt = serverNote.serverUpdatedAt;\n\n      SyncStorage.set(note);\n    }\n\n    this.setSyncStatus(undefined, serverNote);\n  }\n\n  ajaxFail(xhr, status, error, url) {\n    // 0 == UNSENT -> most probably no internet connection\n    if (xhr.readyState === 0) {\n      return;\n    }\n\n    if (xhr.status === 401) {\n      AlertFlash.show(\n        // we could actually link to the current page with `href=\"\"`, but by\n        // doing this the title input field contains the wrong value once we\n        // are redirected back after login (the value is loaded from the\n        // server, and the save request call doesn't update the title field).\n        // the cheap solution for now is to redirect to the root page, so the\n        // user has to click on the note, which will properly update the\n        // fields.\n        // TODO: use the current page link and fix the update of the title\n        // field\n        'Your session has expired. You need to <a href=\"/\" class=\"alert-link\">sign in</a> again.<br>' +\n        \"Your changes won't be lost, once you're signed in they will be saved to the server.\"\n      );\n    }\n    else {\n      AlertFlash.show('Something went sideways: ' + error.toString());\n      console.error('url: ', url, 'xhr: ', xhr, 'status: ', status, 'err: ', error.toString());\n    }\n  }\n}\n\nexport default AutoSave;\n","import React, { Component } from 'react';\nimport $ from 'jquery';\nimport debounce from 'throttle-debounce/debounce';\nimport bootbox from 'bootbox';\nimport './keyboard';\nimport NoteList from './NoteList';\nimport NoteForm from './NoteForm';\nimport Note from './Note';\nimport PushState from  './PushState';\nimport Navbar from './Navbar';\nimport SaveStateLabel from './SaveStateLabel';\nimport AddNoteButton from './AddNoteButton';\nimport AlertFlash from './AlertFlash';\nimport EventHive from './EventHive';\nimport AutoSave from './AutoSave';\n\nclass NoteEdit extends Component {\n  constructor(props, context) {\n    super(props, context);\n\n    this.pushState = new PushState(this.props.history);\n\n    const { match } = this.props;\n\n    if (props.note) {\n      this.initStateFromNote(props.note);\n    }\n    else if (match.params.id) {\n      this.initStateFromNoteId(match.params.id);\n    }\n    else {\n      this.state = this.getNewNoteAttributes();\n    }\n\n    this.handleSearchEnterDebounced = debounce(500, this.handleSearchEnterDebounced);\n  }\n\n  render() {\n    return (\n      <div>\n        {this.renderHeaderBar()}\n        {this.renderContent()}\n      </div>\n    );\n  }\n\n  componentDidMount() {\n    this.autoSave = new AutoSave(this.handleServerSync.bind(this));\n    this.autoSave.startPolling();\n\n    EventHive.subscribe('note.create', (data) => {\n      this.setNewNote(() => {\n        EventHive.publish('hamburger.hide');\n        EventHive.publish('note.update', data);\n      });\n    });\n\n    EventHive.subscribe('note.new', (data) => {\n      this.setNewNote();\n    });\n  }\n\n  renderHeaderBar() {\n    return (\n      <div className=\"row\">\n        <div className=\"col-md-12\">\n          <div className=\"navbar navbar-fixed-top navbar-info navbar-notes\">\n            <Navbar\n              handleSearchEnter={this.handleSearchEnter.bind(this)}\n              handleSearchCleared={this.handleSearchCleared.bind(this)} />\n\n            <SaveStateLabel isSynced={this.state.isSynced} />\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  renderContent() {\n    return (\n      <div className=\"row\">\n        <div className=\"col-md-4\">\n          <NoteList\n            activeNoteUid={this.state.note.uid}\n            isSynced={this.state.isSynced}\n            isInitialEdit={this.state.isInitialEdit}\n            searchQuery={this.state.searchQuery}\n            handleNoteClick={this.handleNoteClick.bind(this)}\n            handleDeleteNoteClick={this.handleDeleteNoteClick.bind(this)} />\n        </div>\n        <div className=\"col-md-8\">\n          <NoteForm\n            note={this.state.note}\n            handleChange={this.handleEditChange.bind(this)} />\n        </div>\n        <AddNoteButton handleNewNoteClick={this.handleNewNoteClick.bind(this)} />\n      </div>\n    );\n  }\n\n  /* eslint-disable react/no-direct-mutation-state */\n  initStateFromNote(note) {\n    this.state = {\n      isInitialEdit: true,\n      note: Note.fromAttributes(note)\n    };\n    this.pushState.setBrowserTitle(note);\n  }\n\n  initStateFromNoteId(id) {\n    // set new note as state, otherwise the state will be undefined\n    this.state = {\n      ...this.getNewNoteAttributes(),\n      isInitialEdit: true\n    };\n\n    $.ajax({\n      url: `/api/notes/${id}`,\n      dataType: 'json',\n    })\n    .done((data) => {\n      const note = Note.fromAttributes(data.note);\n      this.setState({\n        isInitialEdit: true,\n        note: note\n      }, () => this.pushState.setBrowserTitle(note));\n    })\n    .fail((xhr, status, error) => {\n      AlertFlash.show(\n        'While trying to load the note the internet broke down (or something ' +\n          'else failed, maybe the note could not be found)'\n      );\n    })\n  }\n  /* eslint-enable react/no-direct-mutation-state */\n\n  handleNoteClick(note, e) {\n    e.preventDefault();\n\n    this.setState({ note: note });\n    this.pushState.setEdit(note);\n    this.pushState.setBrowserTitle(note);\n  }\n\n  handleDeleteNoteClick(note, e) {\n    e.preventDefault();\n    e.stopPropagation();\n\n    bootbox.confirm('Are you sure? <br> The note will be permanently deleted.', (result) => {\n      if (!result) { return; }\n\n      this.setState({ isSynced: false });\n\n      this.deleteNote(note);\n    });\n  }\n\n  handleNewNoteClick() {\n    this.setNewNote();\n  }\n\n  handleEditChange(note) {\n    this.pushState.setEdit(note);\n\n    this.autoSave.setChange(note);\n  }\n\n  handleServerSync(data) {\n    let state = { isSynced: data.isSynced };\n    // when a note has been synced we need to set the serverUpdatedAt timestamp\n    // for the conflict detection to work\n    // (only do this if the current note is the synced note)\n    if (data.note && this.state.note.uid === data.note.uid) {\n      state.note = this.state.note;\n      state.note.serverUpdatedAt = data.note.serverUpdatedAt;\n    }\n    this.setState(state);\n\n    if (data.isSynced) {\n      this.pushState.setBrowserTitle(this.state.note);\n    }\n  }\n\n  handleSearchEnter(e) {\n    e.persist();\n    this.handleSearchEnterDebounced(e);\n  }\n\n  handleSearchEnterDebounced(e) {\n    this.setState({ searchQuery: e.target.value });\n    EventHive.publish('search.entered');\n  }\n\n  handleSearchCleared() {\n    this.setState({ searchQuery: '' });\n    EventHive.publish('search.entered');\n  }\n\n  getNewNoteAttributes() {\n    return { note: new Note() }\n  }\n\n  setNewNote(afterSetState) {\n    this.setState(this.getNewNoteAttributes(), afterSetState);\n    this.pushState.setNew();\n    this.pushState.setBrowserTitle();\n  }\n\n  deleteNote(note) {\n    $.ajax({\n      url: '/api/notes/' + note.uid,\n      method: 'DELETE',\n      dataType: 'json',\n    })\n    .done(() => {\n      localStorage.removeItem('note-' + note.uid);\n\n      if (this.state.note.uid === note.uid) {\n        this.setNewNote();\n      }\n    })\n    .fail(function(xhr, status, error) {\n      var message = 'Oh my, the note could not be deleted.';\n      // 0 == UNSENT -> most probably no internet connection\n      if (xhr.readyState === 0) {\n        message += \"<br>Please check your internet connection (Well yes, sorry, deleting in offline mode is not yet suppported).\"\n      }\n      AlertFlash.show(message);\n      console.error('note.uid: ', note.uid, 'status: ', status, 'error: ', error.toString());\n    })\n    .always(() => {\n      this.setState({ isSynced: true });\n    });\n  }\n}\n\nexport default NoteEdit;\n","import React, { Component } from 'react';\nimport { HashRouter, Route, Redirect, Switch } from 'react-router-dom';\nimport $ from 'jquery';\nimport './global-jquery'; // bootstrap-material-design needs global jQuery\nimport 'arrive/src/arrive';\nimport 'bootstrap-material-design/dist/js/material';\nimport 'bootstrap-sass/assets/javascripts/bootstrap/modal';\nimport 'bootstrap-sass/assets/javascripts/bootstrap/transition';\nimport 'bootstrap-sass/assets/javascripts/bootstrap/collapse';\nimport Flash from './Flash';\nimport LoginForm from './LoginForm';\nimport NoteEdit from './NoteEdit';\nimport './App.css';\nimport './fonts/roboto.css';\nimport './fonts/material-icons.css';\n\nclass App extends Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      isLoggedIn: null\n    };\n\n    this.setIsLoggedIn();\n  }\n\n  render() {\n    return (\n      <HashRouter>\n        <div className=\"container-fluid\">\n          <Flash />\n          { this.renderLoggedIn() }\n          { this.renderLoggedOut() }\n        </div>\n      </HashRouter>\n    );\n  }\n\n  componentDidMount() {\n    $.material.init();\n  }\n\n  onLoginSuccess() {\n    this.setState({ isLoggedIn: true });\n  }\n\n  setIsLoggedIn() {\n    $.ajax({\n      url: '/users/is_authenticated',\n      method: 'GET',\n      dataType: 'json',\n    })\n    .done((data, status, xhr) =>{\n      this.onLoginSuccess();\n    })\n    .fail(() => {\n      this.setState({ isLoggedIn: false });\n    });\n  }\n\n  renderLoggedIn() {\n    if (this.state.isLoggedIn === true) {\n      return (\n        <Switch>\n          <Route path='/notes/:id' component={ NoteEdit } />\n          <Route path='/notes' component={ NoteEdit } />\n          <Redirect from='/' to='/notes' />\n        </Switch>\n      );\n    }\n  }\n\n  renderLoggedOut() {\n    if (this.state.isLoggedIn === false) {\n      return (\n        <div className=\"row\">\n          <div className=\"col-md-6 col-md-offset-3\">\n            <div className=\"well\">\n              <LoginForm onLoginSuccess={this.onLoginSuccess.bind(this)} />\n            </div>\n          </div>\n        </div>\n      );\n    }\n  }\n}\n\nexport default App;\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import EventHive from './EventHive';\nimport NoticeFlash from './NoticeFlash';\nimport AlertFlash from './AlertFlash';\n\n// expose certain globals that are needed by the mobile app\nexport default function setGlobals() {\n  window.EventHive = EventHive;\n  window.NoticeFlash = NoticeFlash;\n  window.AlertFlash = AlertFlash;\n}\n","import $ from 'jquery';\n\n// ability to set a different host for the API calls. this is needed for the\n// mobile app.\nexport default function setApiHost() {\n  if (!window.API_HOST) { return; }\n\n  $.ajaxPrefilter(function(options) {\n    options.url = window.API_HOST + options.url;\n  });\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport registerServiceWorker from './registerServiceWorker';\nimport setApiHost from './setApiHost';\nimport setGlobals from './setGlobals';\n\nsetGlobals();\nsetApiHost();\n\nReactDOM.render(<App />, document.getElementById('root'));\nregisterServiceWorker();\n"],"sourceRoot":""}