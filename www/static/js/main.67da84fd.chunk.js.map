{"version":3,"sources":["images/logo.svg","global-jquery.js","AbstractFlash.js","NoticeFlash.js","AlertFlash.js","Flash.js","Form.js","scroll.js","UserLinks.js","UserForm.js","LoginForm.js","EventHive.js","keyboard.js","ViewportMode.js","Uuid.js","Note.js","Spinner.js","NoteList.js","highlight.js","NoteForm.js","PushState.js","Navbar.js","SaveStateLabel.js","AddNoteButton.js","SyncStorage.js","AutoSave.js","NoteEdit.js","RegistrationForm.js","App.js","registerServiceWorker.js","setGlobals.js","setApiHost.js","index.js"],"names":["module","exports","__webpack_require__","p","window","jQuery","$","AbstractFlash","props","context","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","state","message","react_default","a","createElement","className","getCssClass","type","onClick","handleClose","bind","dangerouslySetInnerHTML","__html","getAdditionalCssClass","join","setState","_this2","document","on","constructor","getEventName","e","data","off","prototype","getName","trigger","Component","NoticeFlash","AlertFlash","Flash","src_NoticeFlash","src_AlertFlash","TextInput","htmlFor","idValue","label","id","name","nameValue","onChange","target","value","Checkbox","checked","SubmitButton","Utf8","concat","model","attribute","scrollToTop","animate","scrollTop","UserLinks","Route","path","render","Link","to","UserForm","intro","children","LoginForm","defineProperty","alwaysRememberMe","onSubmit","handleFormSubmit","renderTextInput","setValue","preventDefault","ajax","url","method","dataType","done","clear","onLoginSuccess","fail","show","always","EventHive","topic","listener","topics","hasOwnProperty","index","push","remove","info","forEach","item","undefined","_topics","Mousetrap","stopCallback","publish","ViewportMode","envs","doc","temp","body","appendChild","i","length","env","offsetParent","removeChild","mode","getMode","Uuid","replace","c","r","Math","random","toString","Note","uid","title","content","createdAt","updatedAt","archivedAt","_uid","generateV4","_title","_content","_createdAt","Date","_updatedAt","_serverUpdatedAt","_archivedAt","JSON","stringify","created_at","toISOString","updated_at","server_updated_at","serverUpdatedAt","archived_at","attributes","Spinner","viewBox","xmlns","fill","strokeWidth","strokeLinecap","cx","cy","NoteList","notes","currentPage","hasMorePages","isSynced","searchQuery","getListCssClass","ref","$list","renderList","renderNextPageLink","renderListSpinner","_this3","map","note","renderListItem","key","getListItemCssClass","handleNoteClick","getNoteAvatar","renderListItemButton","handleArchiveNoteClick","handleDeleteNoteClick","humanDate","relativeTime","icon","handleNextPageClick","src_Spinner","cssClass","activeNoteUid","isInitialEdit","_this4","toggleListMore","isMobileMode","collapse","toggle","subscribe","listNeedsUpdate","updateList","nextProps","setSearchProgress","removeClass","currentTarget","addClass","_this5","blur","updateListRequest","abort","search","page","executeUpdateListRequest","_this6","fromAttributes","current_page","has_more_pages","xhr","status","error","console","match","previewImageUrl","getPreviewImageUrl","src","alt","linkIsVisible","isInProgress","hljs","highlight","NoteForm","shouldRerender","formContainerElement","renderTitle","renderContent","handleTitleChange","placeholder","titleElement","contentContainerElement","handleChange","contentElement","innerHTML","focusTitleFieldIfNewNote","renderEditor","editor","pasteHTML","classList","add","setText","history","update","handleContentChange","nextState","Quill","theme","modules","syntax","toolbar","header","color","background","list","indent","task-list","querySelector","isNew","focus","PushState","location","pathname","Navbar","showSpinner","renderLogo","renderMobileHamburgerMenu","renderMobileSearchButton","renderSearchBox","logo","subscribeSpinner","subscribeSearch","subscribeMobileSearch","$searchBox","handleSearchEnter","$searchInput","handleSearchCleared","handleHamburgerButtonClick","handleSearchButtonClick","$searchButton","hasClass","$hamburger","val","select","SaveStateLabel","AddNoteButton","handleNewNoteClick","SyncStorage","localStorage","setItem","_getKey","toJson","getItem","callback","keys","_getLocalStorageKeys","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","noteRaw","parse","err","return","removeItem","startsWith","KEY_PREFIX","AutoSave","onServerSync","onServerSyncCallback","setSyncStatus","setInterval","syncToServer","POLLING_INTERVAL","set","active","eachNote","serverNote","ajaxDone","ajaxFail","isEmpty","onbeforeunload","syncStorageRawNote","get","readyState","responseJSON","errors","NoteEdit","pushState","initStateFromNote","params","initStateFromNoteId","getNewNoteAttributes","handleSearchEnterDebounced","debounce","renderHeaderBar","autoSave","handleServerSync","startPolling","setNewNote","src_Navbar","src_SaveStateLabel","src_NoteList_0","src_NoteForm_0","handleEditChange","src_AddNoteButton","setBrowserTitle","objectSpread","setEdit","stopPropagation","bootbox","confirm","result","deleteNote","setArchived","setChange","persist","afterSetState","setNew","RegistrationForm","renderIntro","href","_ref","App","isLoggedIn","setIsLoggedIn","HashRouter","src_Flash","renderLoggedIn","renderLoggedOut","material","init","Switch","component","Redirect","from","src_RegistrationForm","assign","src_LoginForm","ALWAYS_REMEMBER_ME","isLocalhost","Boolean","hostname","registerValidSW","swUrl","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","log","catch","API_HOST","ajaxPrefilter","options","ReactDOM","src_App_0","getElementById","URL","process","origin","addEventListener","fetch","response","headers","indexOf","ready","unregister","reload","checkValidServiceWorker","registerServiceWorker"],"mappings":"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","file":"static/js/main.67da84fd.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/logo.8ad1a424.svg\";","import $ from 'jquery';\n\nwindow.jQuery = $;\nwindow.$ = $;\n","import React, { Component } from 'react';\nimport $ from 'jquery';\n\nclass AbstractFlash extends Component {\n  constructor(props, context) {\n    super(props, context);\n\n    this.state = { message: props.message };\n  }\n\n  render () {\n    if (!this.state.message) {\n      return null;\n    }\n\n    return (\n      <div className=\"row\">\n        <div className=\"col-md-4 col-md-offset-4\">\n          <div className={this.getCssClass()}>\n            <button className=\"close\" type=\"button\" onClick={this.handleClose.bind(this)}>×</button>\n            <div dangerouslySetInnerHTML={{ __html: this.state.message }} />\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  getCssClass() {\n    var cssClasses = ['alert', 'alert-dismissible', this.getAdditionalCssClass()];\n\n    return cssClasses.join(' ');\n  }\n\n  handleClose() {\n    this.setState({ message: null });\n  }\n\n  componentDidMount() {\n    // listen on global event so we can use `NoticeFlash.show('hello')`\n    $(document).on(this.constructor.getEventName(), (e, data) => {\n      this.setState({ message: data.message });\n    });\n  }\n\n  componentWillUnmount() {\n    $(document).off(this.constructor.getEventName());\n  }\n\n  getAdditionalCssClass() {\n  }\n\n  getName() {\n  }\n\n  static getEventName() {\n    return 'mykonote.flash.' + this.prototype.getName();\n  }\n\n  static show(message) {\n    $(document).trigger(this.getEventName(), { message: message });\n  }\n\n  static clear() {\n    $(document).trigger(this.getEventName(), { message: null });\n  }\n}\n\nexport default AbstractFlash;\n","import AbstractFlash from './AbstractFlash';\n\nclass NoticeFlash extends AbstractFlash {\n  getName() {\n    return 'notice';\n  }\n\n  getAdditionalCssClass() {\n    return 'alert-info';\n  }\n}\n\nexport default NoticeFlash;\n","import AbstractFlash from './AbstractFlash';\n\nclass AlertFlash extends AbstractFlash {\n  getName() {\n    return 'alert';\n  }\n\n  getAdditionalCssClass() {\n    return 'alert-warning';\n  }\n}\n\nexport default AlertFlash;\n","import React, { Component } from 'react';\nimport NoticeFlash from './NoticeFlash';\nimport AlertFlash from './AlertFlash';\n\nclass Flash extends Component {\n  render() {\n    return (\n      <div>\n        <NoticeFlash />\n        <AlertFlash />\n      </div>\n    );\n  }\n}\n\nexport default Flash;\n","import React from 'react';\n\nexport function TextInput(props) {\n  return (\n    <div className=\"form-group\">\n      <label\n        htmlFor={idValue(props)}\n        className=\"control-label\">{props.label}</label>\n\n      <input\n        type={props.type}\n        id={idValue(props)}\n        name={nameValue(props)}\n        className=\"string form-control\"\n        onChange={(e) => props.onChange(nameValue(props), e.target.value)} />\n    </div>\n  );\n}\n\nexport function Checkbox(props) {\n  return (\n    <div className=\"form-group\">\n      <div className=\"checkbox\">\n        <label htmlFor={idValue(props)}>\n          <input\n            type=\"checkbox\"\n            id={idValue(props)}\n            name={nameValue(props)}\n            onChange={(e) => props.onChange(nameValue(props), e.target.checked)} />\n\n          {props.label}\n        </label>\n      </div>\n    </div>\n  );\n}\n\nexport function SubmitButton(props) {\n  return (\n    <input\n      type=\"submit\"\n      className=\"btn btn-raised btn-primary btn-info\"\n      value={props.label} />\n  );\n}\n\nexport function Utf8() {\n  return (\n    <input type=\"hidden\" value=\"✓\" name=\"utf8\" />\n  );\n}\n\nfunction idValue(props) {\n  return `${props.model}_${props.attribute}`;\n}\n\nexport function nameValue(props) {\n  return `${props.model}[${props.attribute}]`;\n}\n","import $ from 'jquery';\n\nexport function scrollToTop() {\n  $('html, body').animate({ scrollTop: 0 }, 300)\n}\n","import React from 'react';\nimport { Route, Link } from 'react-router-dom';\n\nexport default function UserLinks() {\n  return (\n    <div>\n      <Route path=\"/login\" render={props => (\n        <Link className=\"btn btn-info btn-link btn-no-padding\" to=\"/register\">Register</Link>\n      )}/>\n\n      <Route path=\"/register\" render={props => (\n        <Link className=\"btn btn-info btn-link btn-no-padding\" to=\"/login\">Login</Link>\n      )}/>\n    </div>\n  );\n}\n","import React from 'react';\nimport UserLinks from './UserLinks';\n\nexport default function UserForm(props) {\n  return (\n    <div className=\"row\">\n      <div className=\"col-md-6 col-md-offset-3\">\n        {props.intro ? (\n          <div className=\"jumbotron\">\n            {props.intro}\n          </div>\n        ) : (\n          null\n        )}\n\n        <div className=\"well\">\n          {props.children}\n\n          <UserLinks />\n        </div>\n      </div>\n    </div>\n  );\n}\n","import React, { Component } from 'react';\nimport $ from 'jquery';\nimport AlertFlash from './AlertFlash';\nimport { TextInput, SubmitButton, Checkbox, Utf8, nameValue } from './Form';\nimport { scrollToTop } from './scroll';\nimport UserForm from './UserForm';\n\nclass LoginForm extends Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      [nameValue({ model: 'user', attribute: 'remember_me' })]: props.alwaysRememberMe\n    };\n  }\n\n  render() {\n    return (\n      <UserForm>\n        <form onSubmit={this.handleFormSubmit.bind(this)}>\n          <Utf8 />\n\n          <div className=\"form-inputs\">\n            {this.renderTextInput(\"email\", \"email\", \"Email\")}\n\n            {this.renderTextInput(\"password\", \"password\", \"Password\")}\n\n            {this.props.alwaysRememberMe ? (\n              null\n            ) : (\n              <Checkbox model=\"user\" attribute=\"remember_me\" label=\"Remember me\"\n                onChange={this.setValue.bind(this)} />\n            )}\n          </div>\n\n          <div className=\"form-actions\">\n            <SubmitButton label=\"Log in\" />\n          </div>\n        </form>\n      </UserForm>\n    );\n  }\n\n  renderTextInput(type, attribute, label) {\n    return (\n      <TextInput\n        type={type}\n        model=\"user\"\n        attribute={attribute}\n        label={label}\n        onChange={this.setValue.bind(this)} />\n    );\n  }\n\n  setValue(name, value) {\n    this.setState({ [name]: value });\n  }\n\n  handleFormSubmit(e) {\n    e.preventDefault();\n\n    $.ajax({\n      url: '/users/sign_in',\n      method: 'POST',\n      dataType: 'json',\n      data: this.state\n    })\n    .done((data) => {\n      AlertFlash.clear();\n      this.props.onLoginSuccess();\n    })\n    .fail(() => {\n      AlertFlash.show('Sorry, that did not work. ' +\n                      'Did you enter a wrong username or a wrong password?')\n    })\n    .always(scrollToTop);\n  }\n}\n\nexport default LoginForm;\n","// credits to https://davidwalsh.name/pubsub-javascript\nclass EventHive {\n  static get topics() {\n    if (typeof this._topics === 'undefined') {\n      this._topics = {};\n    }\n    return this._topics;\n  }\n\n  static subscribe(topic, listener) {\n    // Create the topic's object if not yet created\n    if (!this.topics.hasOwnProperty.call(this.topics, topic)) {\n      this.topics[topic] = [];\n    }\n\n    // Add the listener to queue\n    var index = this.topics[topic].push(listener) -1;\n\n    // Provide handle back for removal of topic\n    return {\n      remove: () => {\n        delete this.topics[topic][index];\n      }\n    };\n  }\n\n  static publish(topic, info) {\n    // If the topic doesn't exist, or there's no listeners in queue, just leave\n    if (!this.topics.hasOwnProperty.call(this.topics, topic)) {\n      return;\n    }\n\n    // Cycle through topics queue, fire!\n    this.topics[topic].forEach(function(item) {\n      item(info !== undefined ? info : {});\n    });\n  }\n}\n\nexport default EventHive;\n","import Mousetrap from 'mousetrap'\nimport EventHive from './EventHive';\n\n// always fire shortcuts inside input fields\nMousetrap.prototype.stopCallback = function() { return false }\n\nMousetrap.bind('alt+shift+f', function() {\n  EventHive.publish('search.focus');\n\n  return false;\n});\n\nMousetrap.bind('alt+shift+n', function() {\n  EventHive.publish('note.new');\n\n  return false;\n});\n","// https://stackoverflow.com/questions/19462672/jquery-detect-bootstrap-3-state/24884634#24884634\nclass ViewportMode {\n  static getMode() {\n    const envs = [\"xs\", \"sm\", \"md\", \"lg\"];\n    const doc = window.document;\n    const temp = doc.createElement(\"div\");\n\n    doc.body.appendChild(temp);\n\n    for (let i = envs.length - 1; i >= 0; i--) {\n      const env = envs[i];\n\n      temp.className = \"hidden-\" + env;\n\n      if (temp.offsetParent === null) {\n        doc.body.removeChild(temp);\n        return env;\n      }\n    }\n    return \"\";\n  }\n\n  static isMobileMode() {\n    const mode = this.getMode();\n    return mode === 'xs' || mode === 'sm';\n  }\n}\n\nexport default ViewportMode;\n","class Uuid  {\n  static generateV4() {\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n      var r = Math.random() * 16 | 0, v = c === 'x' ? r : ((r & 0x3) | 0x8);\n      return v.toString(16);\n    });\n  }\n}\n\nexport default Uuid;\n","import Uuid from './Uuid';\n\nclass Note {\n  constructor(uid, title, content, createdAt, updatedAt, archivedAt) {\n    this._uid = uid || Uuid.generateV4();\n    this._title = title || '';\n    this._content = content || '';\n    this._createdAt = createdAt || new Date();\n    this._updatedAt = updatedAt || this._createdAt;\n    this._serverUpdatedAt = this._updatedAt;\n    this._archivedAt = archivedAt;\n  }\n\n  get uid() { return this._uid }\n\n  get title() { return this._title }\n  set title(title) {\n    this._updatedAt = new Date();\n    this._title = title;\n  }\n\n  get content() { return this._content }\n  set content(content) {\n    this._updatedAt = new Date();\n    this._content = content;\n  }\n\n  get createdAt() { return this._createdAt }\n  get updatedAt() { return this._updatedAt }\n\n  get serverUpdatedAt() { return this._serverUpdatedAt }\n  set serverUpdatedAt(serverUpdatedAt) { this._serverUpdatedAt = serverUpdatedAt }\n\n  get archivedAt() { return this._archivedAt; }\n\n  setArchived() {\n    this._archivedAt = new Date();\n  }\n\n  isNew() {\n    return !this.title && !this.content;\n  }\n\n  toJson() {\n    return JSON.stringify(\n      {\n        uid: this.uid,\n        title: this.title,\n        content: this.content,\n        created_at: this.createdAt.toISOString(),\n        updated_at: this.updatedAt.toISOString(),\n        server_updated_at: this.serverUpdatedAt.toISOString(),\n        archived_at: this.archivedAt ? this.archivedAt.toISOString() : null\n      }\n    );\n  }\n\n  static fromAttributes(attributes) {\n    return new Note(\n      attributes.uid,\n      attributes.title,\n      attributes.content,\n      new Date(attributes.created_at),\n      new Date(attributes.updated_at),\n      attributes.archived_at ? new Date(attributes.archived_at) : null\n    );\n  }\n}\n\nexport default Note;\n","import React from 'react';\n\nfunction Spinner() {\n  return (\n    <svg\n      className=\"spinner\"\n      viewBox=\"0 0 66 66\"\n      xmlns=\"http://www.w3.org/2000/svg\">\n      <circle\n        className=\"path\"\n        fill=\"none\"\n        strokeWidth=\"6\"\n        strokeLinecap=\"round\"\n        cx=\"33\"\n        cy=\"33\"\n        r=\"30\"></circle>\n    </svg>\n  );\n}\n\nexport default Spinner;\n","import React, { Component } from 'react';\nimport humanDate from 'human-date';\nimport $ from 'jquery';\nimport ViewportMode from './ViewportMode';\nimport EventHive from './EventHive';\nimport Note from './Note';\nimport AlertFlash from './AlertFlash';\nimport Spinner from './Spinner';\n\nimport './NoteList.css';\n\nclass NoteList extends Component {\n  constructor(props, context) {\n    super(props, context);\n\n    this.state = {\n      notes: [],\n      currentPage: 1,\n      hasMorePages: false,\n      isSynced: false,\n      searchQuery: undefined\n    };\n  }\n\n  render() {\n    return (\n      <div className={this.getListCssClass()} ref={(c) => this.$list = $(c)}>\n        {this.renderList()}\n        {this.renderNextPageLink()}\n        {this.renderListSpinner()}\n      </div>\n    );\n  }\n\n  renderList() {\n    return this.state.notes.map((note) => this.renderListItem(note));\n  }\n\n  renderListItem(note) {\n    return (\n      <div key={note.uid}>\n        <div\n          className={this.getListItemCssClass(note)}\n          onClick={this.handleNoteClick.bind(this, note)}>\n\n          <div className=\"row-picture\">\n            {this.getNoteAvatar(note)}\n          </div>\n          <div className=\"row-content\">\n            {this.renderListItemButton('action-secondary action-secondary-before', this.props.handleArchiveNoteClick.bind(this, note), 'archive')}\n            {this.renderListItemButton('action-secondary', this.props.handleDeleteNoteClick.bind(this, note), 'delete')}\n            <h4 className=\"list-group-item-heading\">\n              {note.title}\n            </h4>\n            <div className=\"list-group-item-text\">\n              {humanDate.relativeTime(note.updatedAt)}\n            </div>\n          </div>\n        </div>\n        <div className=\"list-group-separator\"></div>\n      </div>\n    );\n  }\n\n  renderListItemButton(className, onClick, icon) {\n    return (\n      <div\n        className={className}\n        onClick={onClick}>\n        <i className=\"material-icons\">{icon}</i>\n      </div>\n    );\n  }\n\n  renderNextPageLink() {\n    if (!this.state.hasMorePages) { return; }\n\n    return (\n      <div className=\"list-more list-more-next-page\">\n        <button onClick={this.handleNextPageClick.bind(this)} className=\"btn btn-info btn-link btn-sm\">\n          <i className=\"material-icons list-more-icon\">expand_more</i>\n        </button>\n      </div>\n    );\n  }\n\n  renderListSpinner() {\n    return (\n      <div className=\"list-more list-more-spinner hidden\">\n        <Spinner />\n      </div>\n    );\n  }\n\n  getListItemCssClass(note) {\n    let cssClass = 'list-group-item note-navigation-item';\n    if (note.uid === this.props.activeNoteUid) {\n      cssClass += ' active';\n    }\n\n    return cssClass;\n  }\n\n  getListCssClass() {\n    // in-sm: show always for non-mobile view\n    let cssClass = 'list-group notes-list collapse in-sm';\n    // show on mobile when not accessing a direct edit url\n    if (!this.props.isInitialEdit) {\n      cssClass += ' in';\n    }\n\n    return cssClass;\n  }\n\n  componentDidMount() {\n    this.toggleListMore(false);\n\n    // handle hamburger and search toggling\n    if (ViewportMode.isMobileMode()) {\n      this.$list.collapse({ toggle: false });\n      // when the hiding animation is done\n      this.$list.on('hidden.bs.collapse', () => {\n        EventHive.publish('hamburger.hide_end');\n      });\n\n      EventHive.subscribe('hamburger.show', () => {\n        this.$list.collapse('show');\n      });\n      EventHive.subscribe('hamburger.hide', () => {\n        this.$list.collapse('hide');\n      });\n\n      EventHive.subscribe('search.entered', () => {\n        this.$list.collapse('show');\n      });\n\n      EventHive.subscribe('note.open', () => {\n        this.$list.collapse('hide');\n      });\n    }\n  }\n\n  componentDidUpdate() {\n    if (this.listNeedsUpdate) {\n      this.listNeedsUpdate = false;\n      this.updateList();\n    }\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (!this.state.isSynced && nextProps.isSynced) {\n      this.listNeedsUpdate = true;\n    }\n\n    if (this.state.searchQuery !== nextProps.searchQuery) {\n      this.listNeedsUpdate = true;\n      this.setSearchProgress(true);\n    }\n\n    this.setState( {\n      isSynced: nextProps.isSynced,\n      searchQuery: nextProps.searchQuery\n    });\n  }\n\n  handleNoteClick(note, e) {\n    $('.note-navigation-item').removeClass('active');\n    $(e.currentTarget).addClass('active');\n\n    if (ViewportMode.isMobileMode()) {\n      EventHive.publish('hamburger.hide');\n    }\n\n    EventHive.publish('note.open');\n    this.props.handleNoteClick(note, e);\n  }\n\n  handleNextPageClick(e) {\n    e.preventDefault();\n    $(e.currentTarget).blur();\n\n    this.toggleListMore(false);\n\n    this.setState({ currentPage: this.state.currentPage + 1 }, () => {\n      this.updateList();\n    });\n  }\n\n  updateList() {\n    if (this.updateListRequest) {\n      this.updateListRequest.abort();\n    }\n\n    this.updateListRequest = $.ajax({\n      url: '/api/notes',\n      dataType: 'json',\n      data: { search: this.state.searchQuery, page: this.state.currentPage }\n    });\n\n    this.executeUpdateListRequest();\n  }\n\n  executeUpdateListRequest() {\n    this.updateListRequest\n      .done((data) => {\n        this.toggleListMore(true);\n\n        const notes = data.notes.map(function(note) {\n          return Note.fromAttributes(note);\n        });\n\n        this.setState({\n          notes: notes,\n          currentPage: data.current_page,\n          hasMorePages: data.has_more_pages\n        });\n      })\n      .fail((xhr, status, error) => {\n        // it's not a failure when the request was aborted by a subsequent\n        // request (see call to `abort()` above).\n        if (error === 'abort') {\n          return;\n        }\n\n        this.toggleListMore(true);\n\n        AlertFlash.show('Watch out, the list is not up to date.');\n        console.error('url: ', this.props.url, 'status: ', status, 'error: ', error.toString());\n      })\n      .always(() => {\n        this.setSearchProgress(false);\n      });\n  }\n\n  getPreviewImageUrl(note) {\n    var match = note.content.match(/<img.*? src=['\"]([^'\"]+)['\"].*?>/);\n    if (match) {\n      return match[1];\n    }\n    else {\n      return null;\n    }\n  }\n\n  getNoteAvatar(note) {\n    var previewImageUrl = this.getPreviewImageUrl(note);\n    if (previewImageUrl) {\n      return <img src={previewImageUrl} className=\"circle\" alt=\"note thumbnail\" />;\n    }\n    else {\n      return <i className=\"material-icons\">subject</i>;\n    }\n  }\n\n  toggleListMore(linkIsVisible) {\n    if (linkIsVisible) {\n      $('.list-more-next-page').removeClass('hidden');\n      $('.list-more-spinner').addClass('hidden');\n    }\n    else {\n      $('.list-more-next-page').addClass('hidden');\n      $('.list-more-spinner').removeClass('hidden');\n    }\n  }\n\n  setSearchProgress(isInProgress) {\n    EventHive.publish('spinner.toggle', { show: isInProgress });\n  }\n}\n\nexport default NoteList;\n","import highlight from 'highlight.js/lib/highlight';\nimport 'highlight.js/styles/railscasts.css';\n\nwindow.hljs = highlight;\n","import './highlight.js';\nimport React, { Component } from 'react';\nimport Quill from 'quill';\nimport 'quill-task-list/task_list_node';\nimport 'quill/dist/quill.snow.css';\nimport './NoteForm.css';\nimport EventHive from './EventHive';\nimport ViewportMode from './ViewportMode';\n\nclass NoteForm extends Component {\n  constructor(props, context) {\n    super(props, context);\n\n    this.state = {\n      note: this.props.note\n    };\n\n    this.shouldRerender = true;\n  }\n\n  render() {\n    return (\n      <div>\n        <form\n          className=\"form-horizontal\"\n          ref={(c) => this.formContainerElement = c}\n          onSubmit={this.handleFormSubmit}>\n          <div className=\"form-inputs\">\n            {this.renderTitle()}\n            {this.renderContent()}\n          </div>\n        </form>\n      </div>\n    );\n  }\n\n  renderTitle() {\n    return (\n      <div className=\"form-group form-group-no-label string optional\">\n        <input\n          type=\"text\"\n          className=\"string optional form-control\"\n          value={this.state.note.title}\n          onChange={this.handleTitleChange.bind(this)}\n          placeholder=\"Title\"\n          ref={(c) => this.titleElement = c}\n        />\n      </div>\n    );\n  }\n\n  renderContent() {\n    return (\n      <div className=\"form-group form-group-no-label text optional\">\n        <div\n          ref={(c) => this.contentContainerElement = c}\n        ></div>\n      </div>\n    );\n  }\n\n  // prevent form submission by hitting enter.\n  // changes will be asynchronously saved by ajax.\n  handleFormSubmit(e) {\n    e.preventDefault();\n    return false;\n  }\n\n  handleTitleChange() {\n    this.shouldRerender = true;\n    const note = this.state.note;\n    note.title = this.titleElement.value;\n    this.setState({ note: note }, this.handleChange);\n  }\n\n  handleContentChange() {\n    this.shouldRerender = false;\n    const note = this.state.note;\n    note.content = this.contentElement.innerHTML;\n    this.setState({ note: note }, this.handleChange);\n  }\n\n  handleChange() {\n    this.props.handleChange(this.state.note);\n  }\n\n  componentDidMount() {\n    this.focusTitleFieldIfNewNote();\n    this.renderEditor();\n\n    // when updating the note from outside (e.g. from the mobile app), in which\n    // case a sync to the server should be triggered. if we just use the react\n    // eventing the rte won't detect the changes.\n    EventHive.subscribe('note.update', (data) => {\n      this.titleElement.value = data.title;\n      this.handleTitleChange();\n      this.editor.pasteHTML(data.content);\n    });\n\n    if (ViewportMode.isMobileMode()) {\n      EventHive.subscribe('hamburger.show', () => {\n        this.formContainerElement.classList.add('hidden');\n      });\n      EventHive.subscribe('hamburger.hide', () => {\n        this.formContainerElement.classList.remove('hidden');\n      });\n\n      EventHive.subscribe('search.entered', () => {\n        this.formContainerElement.classList.add('hidden');\n      });\n    }\n  }\n\n  // gets called initially and when a note is switched\n  componentDidUpdate() {\n    this.editor.off('text-change');\n    // reset the content before inserting the actual content.\n    // presumably because of change tracking (delta stuff) in quill the\n    // insertion of big content hangs the browser for several seconds.\n    this.editor.setText('');\n    this.contentElement.innerHTML = this.state.note.content;\n    this.editor.history.clear();\n    // wait on updates before attaching the `text-change` event\n    this.editor.update();\n    this.editor.on('text-change', this.handleContentChange.bind(this));\n  }\n\n  componentWillReceiveProps(nextProps) {\n    // a different note is shown.\n    if (nextProps.note.uid !== this.state.note.uid) {\n      this.shouldRerender = true;\n      this.setState({\n        note: nextProps.note\n      }, () => this.focusTitleFieldIfNewNote());\n    }\n  }\n\n  shouldComponentUpdate(nextProps, nextState) {\n    // don't rerender if the RTE content changes. the cursor jumps to the\n    // beginning of the content if we re-initialize the RTE content.\n    return this.shouldRerender;\n  }\n\n  renderEditor() {\n    this.editor = new Quill(this.contentContainerElement, {\n      theme: 'snow',\n      modules: {\n        'syntax': true,\n        'toolbar': [\n          [{ 'header': [1, 2, false] }],\n          ['bold', 'italic', 'strike'],\n          [{ 'color': [] }, { 'background': [] }],\n          ['blockquote', 'code-block'],\n          [\n            { 'list': 'ordered' }, { 'list': 'bullet' }, 'task-list',\n            { 'indent': '-1' }, { 'indent': '+1' }\n          ],\n          ['link', 'image'],\n          ['clean']\n        ],\n        'task-list': true\n      }\n    });\n\n    this.contentElement = this.contentContainerElement.querySelector('.ql-editor');\n  }\n\n  focusTitleFieldIfNewNote() {\n    if (this.state.note.isNew()) {\n      this.titleElement.focus();\n    }\n  }\n}\n\nexport default NoteForm;\n","class PushState {\n  constructor(history) {\n    this.history = history;\n  }\n\n  setNew() {\n    this.history.push('/notes');\n  }\n\n  setEdit(note) {\n    const url = `/notes/${note.uid}`;\n\n    if (this.history.location.pathname !== url) {\n      this.history.push(url);\n    }\n  }\n\n  setBrowserTitle(note) {\n    if (note && note.title) {\n      document.title = `${note.title} | Mykonote`;\n    }\n    else {\n      document.title = 'Mykonote';\n    }\n  }\n}\n\nexport default PushState;\n","import React, { Component } from 'react';\nimport $ from 'jquery';\nimport EventHive from './EventHive';\nimport ViewportMode from './ViewportMode';\nimport Spinner from './Spinner';\nimport logo from './images/logo.svg';\n\nclass Navbar extends Component {\n  constructor(props, context) {\n    super(props, context);\n\n    this.state = { showSpinner: false };\n  }\n\n  render() {\n    return (\n      <div className=\"row\">\n        <div className=\"col-md-4\">\n          <div className=\"navbar-header\">\n            {this.renderLogo()}\n            {this.renderMobileHamburgerMenu()}\n            {this.renderMobileSearchButton()}\n          </div>\n          {this.renderSearchBox()}\n        </div>\n      </div>\n    );\n  }\n\n  renderLogo() {\n    return (\n      <div className=\"navbar-brand\">\n        <div className=\"navbar-spinner\">\n          {this.state.showSpinner ? (\n            <Spinner />\n          ) : (\n            <div className=\"navbar-logo\">\n              <img src={logo} alt=\"logo\" />\n            </div>\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  componentDidMount() {\n    this.subscribeSpinner();\n    this.subscribeSearch();\n    this.subscribeMobileSearch();\n  }\n\n  componentWillUnmount() {\n    this.$searchBox.off('shown.bs.collapse');\n  }\n\n  renderSearchBox() {\n    return (\n      <div\n        className=\"navbar-form navbar-right search-bar collapse in-sm\"\n        ref={(c) => this.$searchBox = $(c)}>\n        <input\n          type=\"text\"\n          className=\"string optional form-control search-input\"\n          placeholder=\"Search\"\n          onChange={this.props.handleSearchEnter}\n          ref={(c) => this.$searchInput = $(c)} />\n        <button\n          type=\"button\"\n          className=\"close clear-search\"\n          onClick={this.handleSearchCleared.bind(this)}>×</button>\n      </div>\n    );\n  }\n\n  renderMobileHamburgerMenu() {\n    return (\n      <button\n        className=\"navbar-toggle navbar-hamburger-button\"\n        type=\"button\"\n        onClick={this.handleHamburgerButtonClick}>\n        <span className=\"icon-bar\"></span>\n        <span className=\"icon-bar\"></span>\n        <span className=\"icon-bar\"></span>\n      </button>\n    );\n  }\n\n  renderMobileSearchButton() {\n    return (\n      <button\n        className=\"navbar-toggle navbar-search-button\" type=\"button\"\n        onClick={this.handleSearchButtonClick.bind(this)}\n        ref={(c) => this.$searchButton = $(c)}>\n        <i className=\"material-icons\">search</i>\n      </button>\n    );\n  }\n\n  getSpinnerCssClass() {\n    let cssClass = 'spinner';\n    if (!this.state.showSpinner) {\n      cssClass += ' hidden';\n    }\n\n    return cssClass;\n  }\n\n  getLogoCssClass() {\n    let cssClass = 'navbar-logo';\n    if (this.state.showSpinner) {\n      cssClass += ' hidden';\n    }\n\n    return cssClass;\n  }\n\n  handleSearchButtonClick() {\n    if (!ViewportMode.isMobileMode()) {\n      return;\n    }\n\n    if (this.$searchButton.hasClass('is-expanded')) {\n      this.$searchButton.removeClass('is-expanded');\n      EventHive.publish('search.hide');\n    }\n    else {\n      this.$searchButton.addClass('is-expanded');\n      EventHive.publish('search.show');\n    }\n  }\n\n  handleHamburgerButtonClick(e) {\n    if (!ViewportMode.isMobileMode()) {\n      return;\n    }\n\n    const $hamburger = $(e.target);\n    if ($hamburger.hasClass('is-expanded')) {\n      $hamburger.removeClass('is-expanded');\n      EventHive.publish('hamburger.hide');\n    }\n    else {\n      $hamburger.addClass('is-expanded');\n      EventHive.publish('hamburger.show');\n    }\n  }\n\n  handleSearchCleared(e) {\n    this.$searchInput.val('');\n    $(e.target).blur();\n    this.props.handleSearchCleared();\n  }\n\n  subscribeSpinner() {\n    // listen on global event so we can toggle the spinner from unrelated\n    // components\n    EventHive.subscribe('spinner.toggle', (data) => {\n      this.setState({ showSpinner: data.show });\n    });\n  }\n\n  subscribeSearch() {\n    EventHive.subscribe('search.focus', () => {\n      this.$searchInput.focus();\n      this.$searchInput.select();\n    });\n  }\n\n  subscribeMobileSearch() {\n    // handle hamburger and search toggling\n    if (ViewportMode.isMobileMode()) {\n      EventHive.subscribe('search.hide', () => {\n        this.$searchButton.removeClass('is-expanded');\n      });\n\n      this.$searchBox.collapse({ toggle: false });\n      // when the hiding animation is done\n      this.$searchBox.on('hidden.bs.collapse', () => {\n        EventHive.publish('search.hide_end');\n      });\n\n      EventHive.subscribe('search.show', () => {\n        this.$searchBox.collapse('show');\n      });\n      EventHive.subscribe('search.hide', () => {\n        this.$searchBox.collapse('hide');\n      });\n\n      EventHive.subscribe('note.open', () => {\n        if (this.$searchInput.val() === '') {\n          EventHive.publish('search.hide');\n        }\n      });\n\n      // event when search box is fully toggled (see bootstrap collapse)\n      this.$searchBox.on('shown.bs.collapse', () => {\n        this.$searchInput.focus();\n      });\n    }\n  }\n}\n\nexport default Navbar;\n","import React, { Component } from 'react';\n\nclass SaveStateLabel extends Component {\n  constructor(props, context) {\n    super(props, context);\n\n    this.state = { isSynced: props.isSynced };\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.setState({ isSynced: nextProps.isSynced });\n  }\n\n  render () {\n    return (\n      <div className=\"save-state\">\n        {\n          this.state.isSynced\n            ?\n            <div className=\"label label-success\">Saved</div>\n            :\n            <div className=\"label label-warning\">Saving</div>\n        }\n      </div>\n    );\n  }\n}\n\nexport default SaveStateLabel;\n","import React, { Component } from 'react';\nimport ViewportMode from './ViewportMode';\nimport EventHive from './EventHive';\n\nclass AddNoteButton extends Component {\n  render () {\n    return (\n      <button\n        className=\"btn btn-info btn-fab btn-new-note\"\n        onClick={this.handleNewNoteClick.bind(this)}\n      >\n        <i className=\"material-icons\">add</i>\n      </button>\n    );\n  }\n\n  handleNewNoteClick(e) {\n    e.preventDefault();\n\n    if (ViewportMode.isMobileMode()) {\n      EventHive.publish('hamburger.hide');\n    }\n\n    this.props.handleNewNoteClick();\n  }\n}\n\nexport default AddNoteButton;\n","class SyncStorage {\n  static get KEY_PREFIX() {\n    return 'note-';\n  }\n\n  static set(note) {\n    localStorage.setItem(\n      SyncStorage._getKey(note),\n      note.toJson()\n    );\n  }\n\n  static get(note) {\n    return localStorage.getItem(SyncStorage._getKey(note));\n  }\n\n  static eachNote(callback) {\n    const keys = SyncStorage._getLocalStorageKeys();\n\n    for (let key of keys) {\n      const noteRaw = localStorage.getItem(key);\n      const note = JSON.parse(noteRaw);\n\n      callback(note, noteRaw);\n    }\n  }\n\n  static remove(note) {\n    localStorage.removeItem(SyncStorage._getKey(note));\n  }\n\n  static isEmpty() {\n    return SyncStorage._getLocalStorageKeys().length === 0;\n  }\n\n  static _getLocalStorageKeys() {\n    let keys = [];\n    const length = localStorage.length;\n\n    for (let i = 0; i < length; ++i) {\n      const key = localStorage.key(i);\n\n      if (key.startsWith(SyncStorage.KEY_PREFIX)) {\n        keys.push(key);\n      }\n    }\n\n    return keys;\n  }\n\n  static _getKey(note) {\n    return SyncStorage.KEY_PREFIX + note.uid;\n  }\n}\n\nexport default SyncStorage;\n","import $ from 'jquery';\nimport SyncStorage from './SyncStorage';\nimport Note from './Note';\nimport AlertFlash from './AlertFlash';\n\nclass AutoSave {\n  constructor(onServerSync) {\n    this.onServerSyncCallback = onServerSync;\n\n    this.setSyncStatus();\n  }\n\n  static get POLLING_INTERVAL() {\n    return 3000;\n  }\n\n  startPolling() {\n    setInterval(this.syncToServer.bind(this), AutoSave.POLLING_INTERVAL);\n  }\n\n  setChange(note) {\n    this.setSyncStatus(false);\n\n    SyncStorage.set(note);\n  }\n\n  syncToServer() {\n    if ($.active) {\n      return;\n    }\n\n    SyncStorage.eachNote((note, noteRaw) => {\n      const url = '/api/notes/' + note.uid;\n\n      $.ajax({\n        url: url,\n        method: 'PUT',\n        dataType: 'json',\n        data: { note: note }\n      })\n      // `serverNote` is just a partial note, the response doesn't contain all\n      // attributes\n      .done((serverNote) => this.ajaxDone(note, noteRaw, Note.fromAttributes(serverNote)))\n      .fail((xhr, status, error) => this.ajaxFail(xhr, status, error, url));\n    });\n  }\n\n  setSyncStatus(isSynced, serverNote) {\n    if (isSynced === undefined) {\n      isSynced = SyncStorage.isEmpty();\n    }\n\n    if (isSynced) {\n      window.onbeforeunload = undefined;\n    }\n    else {\n      window.onbeforeunload = function() {\n        return \"Behold! You have unsynchronized changes. \" +\n          \"If you leave the page now, your changes won't be saved to the server.\\n\" +\n          \"(Your data won't be lost, but it will only remain locally in your browser)\";\n      };\n    }\n    this.onServerSyncCallback({ isSynced: isSynced, note: serverNote });\n  }\n\n  ajaxDone(note, noteRaw, serverNote) {\n    // if the content is still the same -> clear from sync storage\n    const syncStorageRawNote = SyncStorage.get(note);\n    if (noteRaw === syncStorageRawNote) {\n      SyncStorage.remove(note);\n    }\n    else {\n      // update the server updated at in the sync storage item as well.  the\n      // content may have been updated in the meantime from the same source. if\n      // we don't do this we will get a conflict, which is not what we want in\n      // this case.\n      const note = Note.fromAttributes(JSON.parse(syncStorageRawNote));\n      note.serverUpdatedAt = serverNote.serverUpdatedAt;\n\n      SyncStorage.set(note);\n    }\n\n    this.setSyncStatus(undefined, serverNote);\n  }\n\n  ajaxFail(xhr, status, error, url) {\n    // 0 == UNSENT -> most probably no internet connection\n    if (xhr.readyState === 0) {\n      return;\n    }\n\n    if (xhr.status === 401) {\n      AlertFlash.show(\n        // we could actually link to the current page with `href=\"\"`, but by\n        // doing this the title input field contains the wrong value once we\n        // are redirected back after login (the value is loaded from the\n        // server, and the save request call doesn't update the title field).\n        // the cheap solution for now is to redirect to the root page, so the\n        // user has to click on the note, which will properly update the\n        // fields.\n        // TODO: use the current page link and fix the update of the title\n        // field\n        'Your session has expired. You need to <a href=\"/\" class=\"alert-link\">sign in</a> again.<br>' +\n        \"Your changes won't be lost, once you're signed in they will be saved to the server.\"\n      );\n    }\n    else if (xhr.status === 422) {\n      AlertFlash.show(xhr.responseJSON.errors.join('<br>'));\n    }\n    else {\n      AlertFlash.show('Something went sideways: ' + error.toString());\n      console.error('url: ', url, 'xhr: ', xhr, 'status: ', status, 'err: ', error.toString());\n    }\n  }\n}\n\nexport default AutoSave;\n","import React, { Component } from 'react';\nimport $ from 'jquery';\nimport debounce from 'throttle-debounce/debounce';\nimport bootbox from 'bootbox';\nimport './keyboard';\nimport NoteList from './NoteList';\nimport NoteForm from './NoteForm';\nimport Note from './Note';\nimport PushState from  './PushState';\nimport Navbar from './Navbar';\nimport SaveStateLabel from './SaveStateLabel';\nimport AddNoteButton from './AddNoteButton';\nimport AlertFlash from './AlertFlash';\nimport EventHive from './EventHive';\nimport AutoSave from './AutoSave';\n\nclass NoteEdit extends Component {\n  constructor(props, context) {\n    super(props, context);\n\n    this.pushState = new PushState(this.props.history);\n\n    const { match } = this.props;\n\n    if (props.note) {\n      this.initStateFromNote(props.note);\n    }\n    else if (match.params.id) {\n      this.initStateFromNoteId(match.params.id);\n    }\n    else {\n      this.state = this.getNewNoteAttributes();\n    }\n\n    this.handleSearchEnterDebounced = debounce(500, this.handleSearchEnterDebounced);\n  }\n\n  render() {\n    return (\n      <div>\n        {this.renderHeaderBar()}\n        {this.renderContent()}\n      </div>\n    );\n  }\n\n  componentDidMount() {\n    this.autoSave = new AutoSave(this.handleServerSync.bind(this));\n    this.autoSave.startPolling();\n\n    EventHive.subscribe('note.create', (data) => {\n      this.setNewNote(() => {\n        EventHive.publish('hamburger.hide');\n        EventHive.publish('note.update', data);\n      });\n    });\n\n    EventHive.subscribe('note.new', (data) => {\n      this.setNewNote();\n    });\n  }\n\n  renderHeaderBar() {\n    return (\n      <div className=\"row\">\n        <div className=\"col-md-12\">\n          <div className=\"navbar navbar-fixed-top navbar-info navbar-notes\">\n            <Navbar\n              handleSearchEnter={this.handleSearchEnter.bind(this)}\n              handleSearchCleared={this.handleSearchCleared.bind(this)} />\n\n            <SaveStateLabel isSynced={this.state.isSynced} />\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  renderContent() {\n    return (\n      <div className=\"row\">\n        <div className=\"col-md-4\">\n          <NoteList\n            activeNoteUid={this.state.note.uid}\n            isSynced={this.state.isSynced}\n            isInitialEdit={this.state.isInitialEdit}\n            searchQuery={this.state.searchQuery}\n            handleNoteClick={this.handleNoteClick.bind(this)}\n            handleDeleteNoteClick={this.handleDeleteNoteClick.bind(this)}\n            handleArchiveNoteClick={this.handleArchiveNoteClick.bind(this)} />\n        </div>\n        <div className=\"col-md-8\">\n          <NoteForm\n            note={this.state.note}\n            handleChange={this.handleEditChange.bind(this)} />\n        </div>\n        <AddNoteButton handleNewNoteClick={this.handleNewNoteClick.bind(this)} />\n      </div>\n    );\n  }\n\n  /* eslint-disable react/no-direct-mutation-state */\n  initStateFromNote(note) {\n    this.state = {\n      isInitialEdit: true,\n      note: Note.fromAttributes(note)\n    };\n    this.pushState.setBrowserTitle(note);\n  }\n\n  initStateFromNoteId(id) {\n    // set new note as state, otherwise the state will be undefined\n    this.state = {\n      ...this.getNewNoteAttributes(),\n      isInitialEdit: true\n    };\n\n    $.ajax({\n      url: `/api/notes/${id}`,\n      dataType: 'json',\n    })\n    .done((data) => {\n      const note = Note.fromAttributes(data.note);\n      this.setState({\n        isInitialEdit: true,\n        note: note\n      }, () => this.pushState.setBrowserTitle(note));\n    })\n    .fail((xhr, status, error) => {\n      AlertFlash.show(\n        'While trying to load the note the internet broke down (or something ' +\n          'else failed, maybe the note could not be found)'\n      );\n    })\n  }\n  /* eslint-enable react/no-direct-mutation-state */\n\n  handleNoteClick(note, e) {\n    e.preventDefault();\n\n    this.setState({ note: note });\n    this.pushState.setEdit(note);\n    this.pushState.setBrowserTitle(note);\n  }\n\n  handleDeleteNoteClick(note, e) {\n    e.preventDefault();\n    e.stopPropagation();\n\n    bootbox.confirm('Are you sure? <br> The note will be permanently deleted.', (result) => {\n      if (!result) { return; }\n\n      this.setState({ isSynced: false });\n\n      this.deleteNote(note);\n    });\n  }\n\n  handleArchiveNoteClick(note, e) {\n    e.preventDefault();\n    e.stopPropagation();\n\n    bootbox.confirm('Are you sure you want to archive this note?', (result) => {\n      if (!result) { return; }\n\n      note.setArchived();\n      this.handleEditChange(note)\n      this.setNewNote();\n    });\n  }\n\n  handleNewNoteClick() {\n    this.setNewNote();\n  }\n\n  handleEditChange(note) {\n    this.pushState.setEdit(note);\n\n    this.autoSave.setChange(note);\n  }\n\n  handleServerSync(data) {\n    let state = { isSynced: data.isSynced };\n    // when a note has been synced we need to set the serverUpdatedAt timestamp\n    // for the conflict detection to work\n    // (only do this if the current note is the synced note)\n    if (data.note && this.state.note.uid === data.note.uid) {\n      state.note = this.state.note;\n      state.note.serverUpdatedAt = data.note.serverUpdatedAt;\n    }\n    this.setState(state);\n\n    if (data.isSynced) {\n      this.pushState.setBrowserTitle(this.state.note);\n    }\n  }\n\n  handleSearchEnter(e) {\n    e.persist();\n    this.handleSearchEnterDebounced(e);\n  }\n\n  handleSearchEnterDebounced(e) {\n    this.setState({ searchQuery: e.target.value });\n    EventHive.publish('search.entered');\n  }\n\n  handleSearchCleared() {\n    this.setState({ searchQuery: '' });\n    EventHive.publish('search.entered');\n  }\n\n  getNewNoteAttributes() {\n    return { note: new Note() }\n  }\n\n  setNewNote(afterSetState) {\n    this.setState(this.getNewNoteAttributes(), afterSetState);\n    this.pushState.setNew();\n    this.pushState.setBrowserTitle();\n  }\n\n  deleteNote(note) {\n    $.ajax({\n      url: '/api/notes/' + note.uid,\n      method: 'DELETE',\n      dataType: 'json',\n    })\n    .done(() => {\n      localStorage.removeItem('note-' + note.uid);\n\n      if (this.state.note.uid === note.uid) {\n        this.setNewNote();\n      }\n    })\n    .fail(function(xhr, status, error) {\n      var message = 'Oh my, the note could not be deleted.';\n      // 0 == UNSENT -> most probably no internet connection\n      if (xhr.readyState === 0) {\n        message += \"<br>Please check your internet connection (Well yes, sorry, deleting in offline mode is not yet suppported).\"\n      }\n      AlertFlash.show(message);\n      console.error('note.uid: ', note.uid, 'status: ', status, 'error: ', error.toString());\n    })\n    .always(() => {\n      this.setState({ isSynced: true });\n    });\n  }\n}\n\nexport default NoteEdit;\n","import React, { Component } from 'react';\nimport $ from 'jquery';\nimport AlertFlash from './AlertFlash';\nimport NoticeFlash from './NoticeFlash';\nimport { TextInput, SubmitButton, Utf8 } from './Form';\nimport { scrollToTop } from './scroll';\nimport UserForm from './UserForm';\n\nclass RegistrationForm extends Component {\n  render() {\n    return (\n      <UserForm intro={this.renderIntro()}>\n        <form onSubmit={this.handleFormSubmit.bind(this)}>\n          <Utf8 />\n\n          <div className=\"form-inputs\">\n            {this.renderTextInput(\"email\", \"email\", \"Email\")}\n\n            {this.renderTextInput(\"password\", \"password\", \"Password\")}\n\n            {this.renderTextInput(\"password\", \"password_confirmation\", \"Confirm password\")}\n          </div>\n\n          <div className=\"form-actions\">\n            <SubmitButton label=\"Register\" />\n          </div>\n        </form>\n      </UserForm>\n    );\n  }\n\n  renderIntro() {\n    return (\n      <div>\n        <p>\n          You can register for a <strong>free account</strong> which <strong>limits</strong> you to <strong>100 notes</strong>.\n          <br/>\n          This free hosting service is sponsored by <a href=\"https://www.panter.ch\">Panter AG</a>.\n        </p>\n        <p>\n          Alternatively you may <a href=\"https://github.com/panter/mykonote\">get the source code from\n          GitHub</a> and install it on a server on your own.\n        </p>\n      </div>\n    );\n  }\n\n  renderTextInput(type, attribute, label) {\n    return (\n      <TextInput\n        type={type}\n        model=\"user\"\n        attribute={attribute}\n        label={label}\n        onChange={this.setValue.bind(this)} />\n    );\n  }\n\n  setValue(name, value) {\n    this.setState({ [name]: value });\n  }\n\n  handleFormSubmit(e) {\n    e.preventDefault();\n\n    $.ajax({\n      url: '/users',\n      method: 'POST',\n      dataType: 'json',\n      data: this.state\n    })\n    .done((data) => {\n      AlertFlash.clear();\n      NoticeFlash.show(\n        'Great! Glad you made it!<br>' +\n          'You have been subscribed to the <strong>free plan</strong> which ' +\n          '<strong>limits</strong> you to have <strong>100 notes</strong>.'\n      )\n      this.props.onLoginSuccess();\n      this.props.history.push('/notes')\n    })\n    .fail(({ responseJSON }) => {\n      const errors = responseJSON.errors.join('<br>');\n\n      AlertFlash.show('Sorry, that did not work. You need to fix your inputs:<br>' + errors)\n    })\n    .always(scrollToTop);\n  }\n}\n\nexport default RegistrationForm;\n","import React, { Component } from 'react';\nimport { HashRouter as Router, Route, Redirect, Switch } from 'react-router-dom';\nimport $ from 'jquery';\nimport './global-jquery'; // bootstrap-material-design needs global jQuery\nimport 'arrive/src/arrive';\nimport 'bootstrap-material-design/dist/js/material';\nimport 'bootstrap-sass/assets/javascripts/bootstrap/modal';\nimport 'bootstrap-sass/assets/javascripts/bootstrap/transition';\nimport 'bootstrap-sass/assets/javascripts/bootstrap/collapse';\nimport Flash from './Flash';\nimport LoginForm from './LoginForm';\nimport NoteEdit from './NoteEdit';\nimport RegistrationForm from './RegistrationForm';\nimport './App.css';\nimport './fonts/roboto.css';\nimport './fonts/material-icons.css';\n\nclass App extends Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      isLoggedIn: null\n    };\n\n    this.setIsLoggedIn();\n  }\n\n  render() {\n    return (\n      <Router>\n        <div className=\"container-fluid\">\n          <Flash />\n          { this.renderLoggedIn() }\n          { this.renderLoggedOut() }\n        </div>\n      </Router>\n    );\n  }\n\n  componentDidMount() {\n    $.material.init();\n  }\n\n  onLoginSuccess() {\n    this.setState({ isLoggedIn: true });\n  }\n\n  setIsLoggedIn() {\n    $.ajax({\n      url: '/users/is_authenticated',\n      method: 'GET',\n      dataType: 'json',\n    })\n    .done((data, status, xhr) =>{\n      this.onLoginSuccess();\n    })\n    .fail(() => {\n      this.setState({ isLoggedIn: false });\n    });\n  }\n\n  renderLoggedIn() {\n    if (this.state.isLoggedIn === true) {\n      return (\n        <Switch>\n          <Route path='/notes/:id' component={ NoteEdit } />\n          <Route path='/notes' component={ NoteEdit } />\n          <Redirect from='/' to='/notes' />\n        </Switch>\n      );\n    }\n  }\n\n  renderLoggedOut() {\n    if (this.state.isLoggedIn === false) {\n      return (\n        <Switch>\n          <Route path='/register' render={props => (\n            <RegistrationForm onLoginSuccess={this.onLoginSuccess.bind(this)} {...props} />\n          )}/>\n\n          <Route path='/login' render={props => (\n            <LoginForm onLoginSuccess={this.onLoginSuccess.bind(this)} alwaysRememberMe={window.ALWAYS_REMEMBER_ME} />\n          )}/>\n\n          <Redirect to='/login' />\n        </Switch>\n      );\n    }\n  }\n}\n\nexport default App;\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import EventHive from './EventHive';\nimport NoticeFlash from './NoticeFlash';\nimport AlertFlash from './AlertFlash';\n\n// expose certain globals that are needed by the mobile app\nexport default function setGlobals() {\n  window.EventHive = EventHive;\n  window.NoticeFlash = NoticeFlash;\n  window.AlertFlash = AlertFlash;\n}\n","import $ from 'jquery';\n\n// ability to set a different host for the API calls. this is needed for the\n// mobile app.\nexport default function setApiHost() {\n  if (!window.API_HOST) { return; }\n\n  $.ajaxPrefilter(function(options) {\n    options.url = window.API_HOST + options.url;\n  });\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport registerServiceWorker from './registerServiceWorker';\nimport setApiHost from './setApiHost';\nimport setGlobals from './setGlobals';\n\nsetGlobals();\nsetApiHost();\n\nReactDOM.render(<App />, document.getElementById('root'));\nregisterServiceWorker();\n"],"sourceRoot":""}